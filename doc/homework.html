<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="WANG Yu" />

<meta name="date" content="2020-12-20" />

<title>Homework R Code</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework R Code</h1>
<h4 class="author">WANG Yu</h4>
<h4 class="date">2020-12-20</h4>



<div id="homwework-1" class="section level1">
<h1>HOMWEWORK 1</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce 3 examples in the book.</p>
<ol style="list-style-type: decimal">
<li><p>The 1st example should contain texts and at least one figure.</p></li>
<li><p>The 2nd example should contains texts and at least one table.</p></li>
<li><p>The 3rd example should contain at least a couple of LaTeX formulas.</p></li>
</ol>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<ol style="list-style-type: decimal">
<li>Donald John Trump, president of the United States of America, is a man with great ambition. He devoted himself completely into the liberation of mankind. As a member of the Communist Party, he always remembers his duty and takes it into action. He cheated, he lay, he stole, he fooled all the Americans. He is the king of the sun. He deserves a medal weighed 5 tons.</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&#39;donald.jpg&#39;</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<ul>
<li>Countries have the Largest population in the world</li>
</ul>
<span class="math display">\[\begin{array}{|c|l|l|}
\hline
rank &amp; Country( or Region) &amp; Population \\
\hline
1 &amp; Mainland \ China    &amp; 1394750000    \\

  &amp; Hongkong \ China    &amp; 7482500       \\
  
  &amp; Taiwan   \ China    &amp; 23590744      \\
  
  &amp; Mocao    \ China    &amp; 667400        \\
\hline
2 &amp; India               &amp; 13442700000   \\
\hline
3 &amp; America             &amp; 328802000     \\
\hline
4 &amp; Indonesia           &amp; 268074600     \\
\hline
5 &amp; Bazil               &amp; 209598000     \\
\hline
6 &amp; Pakistan            &amp; 203885000     \\
\hline
7 &amp; Nigeria             &amp; 193392517     \\
\hline      
8 &amp; Bangladesh          &amp; 166155000     \\
\hline
9 &amp; Russia              &amp; 146793744     \\
\hline
10 &amp; Mexico             &amp; 126577691     \\
\hline
\end{array}\]</span>
<ul>
<li>Information about the fate of passengers on the fatal maiden voyage of the ocean liner ‘Titanic’.</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">Class</th>
<th align="left">Sex</th>
<th align="left">Age</th>
<th align="left">Survived</th>
<th align="right">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1st</td>
<td align="left">Male</td>
<td align="left">Child</td>
<td align="left">No</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2nd</td>
<td align="left">Male</td>
<td align="left">Child</td>
<td align="left">No</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">3rd</td>
<td align="left">Male</td>
<td align="left">Child</td>
<td align="left">No</td>
<td align="right">35</td>
</tr>
<tr class="even">
<td align="left">Crew</td>
<td align="left">Male</td>
<td align="left">Child</td>
<td align="left">No</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">1st</td>
<td align="left">Female</td>
<td align="left">Child</td>
<td align="left">No</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2nd</td>
<td align="left">Female</td>
<td align="left">Child</td>
<td align="left">No</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">3rd</td>
<td align="left">Female</td>
<td align="left">Child</td>
<td align="left">No</td>
<td align="right">17</td>
</tr>
<tr class="even">
<td align="left">Crew</td>
<td align="left">Female</td>
<td align="left">Child</td>
<td align="left">No</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">1st</td>
<td align="left">Male</td>
<td align="left">Adult</td>
<td align="left">No</td>
<td align="right">118</td>
</tr>
<tr class="even">
<td align="left">2nd</td>
<td align="left">Male</td>
<td align="left">Adult</td>
<td align="left">No</td>
<td align="right">154</td>
</tr>
<tr class="odd">
<td align="left">3rd</td>
<td align="left">Male</td>
<td align="left">Adult</td>
<td align="left">No</td>
<td align="right">387</td>
</tr>
<tr class="even">
<td align="left">Crew</td>
<td align="left">Male</td>
<td align="left">Adult</td>
<td align="left">No</td>
<td align="right">670</td>
</tr>
<tr class="odd">
<td align="left">1st</td>
<td align="left">Female</td>
<td align="left">Adult</td>
<td align="left">No</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">2nd</td>
<td align="left">Female</td>
<td align="left">Adult</td>
<td align="left">No</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="left">3rd</td>
<td align="left">Female</td>
<td align="left">Adult</td>
<td align="left">No</td>
<td align="right">89</td>
</tr>
<tr class="even">
<td align="left">Crew</td>
<td align="left">Female</td>
<td align="left">Adult</td>
<td align="left">No</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">1st</td>
<td align="left">Male</td>
<td align="left">Child</td>
<td align="left">Yes</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">2nd</td>
<td align="left">Male</td>
<td align="left">Child</td>
<td align="left">Yes</td>
<td align="right">11</td>
</tr>
<tr class="odd">
<td align="left">3rd</td>
<td align="left">Male</td>
<td align="left">Child</td>
<td align="left">Yes</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="left">Crew</td>
<td align="left">Male</td>
<td align="left">Child</td>
<td align="left">Yes</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">1st</td>
<td align="left">Female</td>
<td align="left">Child</td>
<td align="left">Yes</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">2nd</td>
<td align="left">Female</td>
<td align="left">Child</td>
<td align="left">Yes</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="left">3rd</td>
<td align="left">Female</td>
<td align="left">Child</td>
<td align="left">Yes</td>
<td align="right">14</td>
</tr>
<tr class="even">
<td align="left">Crew</td>
<td align="left">Female</td>
<td align="left">Child</td>
<td align="left">Yes</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">1st</td>
<td align="left">Male</td>
<td align="left">Adult</td>
<td align="left">Yes</td>
<td align="right">57</td>
</tr>
<tr class="even">
<td align="left">2nd</td>
<td align="left">Male</td>
<td align="left">Adult</td>
<td align="left">Yes</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="left">3rd</td>
<td align="left">Male</td>
<td align="left">Adult</td>
<td align="left">Yes</td>
<td align="right">75</td>
</tr>
<tr class="even">
<td align="left">Crew</td>
<td align="left">Male</td>
<td align="left">Adult</td>
<td align="left">Yes</td>
<td align="right">192</td>
</tr>
<tr class="odd">
<td align="left">1st</td>
<td align="left">Female</td>
<td align="left">Adult</td>
<td align="left">Yes</td>
<td align="right">140</td>
</tr>
<tr class="even">
<td align="left">2nd</td>
<td align="left">Female</td>
<td align="left">Adult</td>
<td align="left">Yes</td>
<td align="right">80</td>
</tr>
<tr class="odd">
<td align="left">3rd</td>
<td align="left">Female</td>
<td align="left">Adult</td>
<td align="left">Yes</td>
<td align="right">76</td>
</tr>
<tr class="even">
<td align="left">Crew</td>
<td align="left">Female</td>
<td align="left">Adult</td>
<td align="left">Yes</td>
<td align="right">20</td>
</tr>
</tbody>
</table>
<ol start="3" style="list-style-type: decimal">
<li>If <span class="math inline">\(\{f_n\}\)</span> is a sequence of extended real valued, measurable functions on a measurable space <span class="math inline">\(X\)</span>, then each of the four functions <span class="math inline">\(h,g,f^*\)</span>, and <span class="math inline">\(f_*\)</span>, defined by</li>
</ol>
<p><span class="math display">\[h(x) = \sup \{f_n(x):n = 1, 2, \dots\},\]</span></p>
<p><span class="math display">\[g(x) = \inf \{f_n(x):n = 1, 2, \dots\},\]</span></p>
<p><span class="math display">\[f^*(x) = \limsup_n f_n(x),\]</span></p>
<p><span class="math display">\[f_*(x) = \liminf_n f_n(x)\]</span></p>
<p>is measurable.</p>
</div>
</div>
<div id="homework-2" class="section level1">
<h1>HOMEWORK 2</h1>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>3.3 The <span class="math inline">\(Pareto(a, b)\)</span> distribution has cdf</p>
<p><span class="math display">\[F(x) = 1 − (\frac{b}{x})^a , x \geq b &gt; 0, a &gt; 0.\]</span></p>
<p>Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the <span class="math inline">\(Pareto(2, 2)\)</span> distribution. Graph the density histogram of the sample with the <span class="math inline">\(Pareto(2, 2)\)</span> density superimposed for comparison.</p>
<p>3.9 The rescaled Epanechnikov kernel [85] is a symmetric density function</p>
<p><span class="math display">\[f_e(x) = \frac34(1-x^2),|x|\leq 1\]</span> Devroye and Gyorfi [71, p.236] give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U1, U2, U3 \sim U(−1, 1)\)</span>. If |<span class="math inline">\(U_3| \geq|U_2|\ and\ |U_3| \geq |U_1|\)</span>, deliver <span class="math inline">\(U_2\)</span>; otherwise deliver <span class="math inline">\(U_3\)</span>. Write a function to generate random variates from <span class="math inline">\(f_e\)</span>, and construct the histogram density estimate of a large simulated random sample.</p>
<p>3.10 Prove that the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_e\)</span>.</p>
<p>3.13 It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf</p>
<p><span class="math display">\[F(y) = 1 − (\fracβ{β+y})^r, y\geq 0.\]</span></p>
<p>(This is an alternative parameterization of the <span class="math inline">\(Pareto\)</span> cdf given in Exercise 3.3.) Generate 1000 random observations from the mixture with <span class="math inline">\(r = 4\)</span> and <span class="math inline">\(\beta = 2\)</span>. Compare the empirical and theoretical (<span class="math inline">\(Pareto\)</span>) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="section" class="section level3">
<h3>3.3</h3>
<p>Use inverse transform method to generate some random samples for <span class="math inline">\(Pareto(2, 2)\)</span>, graph its density histogram compared with density curve of <span class="math inline">\(Pareto(2, 2)\)</span> distribution.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># homework 3.3</span></span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb2-5"><a href="#cb2-5"></a></span>
<span id="cb2-6"><a href="#cb2-6"></a>n_sample &lt;-<span class="st"> </span><span class="dv">200</span></span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co"># generate n.sample random numbers subject to U(0, 1)</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n_sample)</span>
<span id="cb2-10"><a href="#cb2-10"></a></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co"># generate Pareto distribution random numbers</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>pareto &lt;-<span class="st"> </span><span class="fl">2.</span> <span class="op">*</span><span class="st"> </span>(u<span class="op">^</span>(<span class="op">-</span><span class="fl">0.5</span>))</span>
<span id="cb2-13"><a href="#cb2-13"></a></span>
<span id="cb2-14"><a href="#cb2-14"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="fl">.01</span>)</span>
<span id="cb2-15"><a href="#cb2-15"></a>y &lt;-<span class="st"> </span><span class="dv">8</span> <span class="op">/</span><span class="st"> </span>(x<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb2-16"><a href="#cb2-16"></a></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="co"># draw a histogram of these numbers</span></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="kw">hist</span>(pareto, <span class="dt">freq =</span> F, <span class="dt">col =</span> <span class="st">&#39;red&#39;</span>, <span class="dt">breaks =</span> <span class="dv">50</span>, <span class="dt">main =</span> <span class="st">&quot;Histogram of Pareto(2, 2) Distribution&quot;</span>)</span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="kw">lines</span>(x, y, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="and-3.10" class="section level3">
<h3>3.9 and 3.10</h3>
<p>Simulate some samples with the function implemented with the idea given. Graph density histogram of these samples.</p>
<p>Use Kolmogorov-Smirnov tests to test whether <span class="math inline">\(b\)</span> yileds the distribution <span class="math inline">\(F\)</span>. From the test, p-value is 0.8646. So these variates are from density <span class="math inline">\(f_e\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co"># homework 3.9</span></span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co"># generate numbers yield the chosen distribution</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>generate &lt;-<span class="st"> </span><span class="cf">function</span>(n){</span>
<span id="cb3-8"><a href="#cb3-8"></a>    result &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb3-9"><a href="#cb3-9"></a>    u1 &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">runif</span>(n) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>    u2 &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">runif</span>(n) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>    u3 &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">runif</span>(n) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb3-12"><a href="#cb3-12"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb3-13"><a href="#cb3-13"></a>        <span class="cf">if</span>((<span class="kw">abs</span>(u3[i]) <span class="op">&gt;</span><span class="st"> </span><span class="kw">abs</span>(u2[i])) <span class="op">&amp;&amp;</span><span class="st"> </span>(<span class="kw">abs</span>(u3[i]) <span class="op">&gt;</span><span class="st"> </span><span class="kw">abs</span>(u1[i]))){</span>
<span id="cb3-14"><a href="#cb3-14"></a>            result[i] &lt;-<span class="st"> </span>u2[i]</span>
<span id="cb3-15"><a href="#cb3-15"></a>        }</span>
<span id="cb3-16"><a href="#cb3-16"></a>        <span class="cf">else</span> {</span>
<span id="cb3-17"><a href="#cb3-17"></a>            result[i] &lt;-<span class="st"> </span>u3[i]</span>
<span id="cb3-18"><a href="#cb3-18"></a>        }</span>
<span id="cb3-19"><a href="#cb3-19"></a>    }</span>
<span id="cb3-20"><a href="#cb3-20"></a>    result</span>
<span id="cb3-21"><a href="#cb3-21"></a>}</span>
<span id="cb3-22"><a href="#cb3-22"></a></span>
<span id="cb3-23"><a href="#cb3-23"></a>b &lt;-<span class="st"> </span><span class="kw">generate</span>(<span class="dv">1000</span>)</span>
<span id="cb3-24"><a href="#cb3-24"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)</span>
<span id="cb3-25"><a href="#cb3-25"></a>y &lt;-<span class="st"> </span><span class="fl">0.75</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb3-26"><a href="#cb3-26"></a></span>
<span id="cb3-27"><a href="#cb3-27"></a><span class="co"># make a histogram of @vector b</span></span>
<span id="cb3-28"><a href="#cb3-28"></a><span class="kw">hist</span>(b, <span class="dt">main =</span> <span class="st">&quot;Sample Density Histogram, Funciton Curve of fe&quot;</span>, <span class="dt">freq =</span> F, <span class="dt">breaks =</span> <span class="dv">50</span>)</span>
<span id="cb3-29"><a href="#cb3-29"></a><span class="co"># line the density function</span></span>
<span id="cb3-30"><a href="#cb3-30"></a><span class="kw">lines</span>(x, y, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># homework 3.10</span></span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># CDF of the chosen distribution</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>F &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb4-5"><a href="#cb4-5"></a>    <span class="fl">0.75</span> <span class="op">*</span><span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="fl">0.25</span> <span class="op">*</span><span class="st"> </span>(x<span class="op">^</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>}</span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co"># use Kolmogorov-Smirnov tests to test whether b yileds F</span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="kw">ks.test</span>(b, F)</span></code></pre></div>
<pre><code># 
#   One-sample Kolmogorov-Smirnov test
# 
# data:  b
# D = 0.018967, p-value = 0.8646
# alternative hypothesis: two-sided</code></pre>
</div>
<div id="section-1" class="section level3">
<h3>3.10</h3>
<p>We can simplify the question by regarding <span class="math inline">\(u_1,u_2,u_3 \sim U(0,1)\)</span> and choosing <span class="math inline">\(u_2\)</span> if <span class="math inline">\(u_3\geq u_1,u_2\)</span> otherwise <span class="math inline">\(u_3\)</span>. Then, our goal is to proof that <span class="math inline">\(u\sim f_e = \frac32(1-x^2);0\leq x\leq 1\)</span>.</p>
<p>It is easy to prove that <span class="math inline">\(p(u=u_{(1)})=p(u=u_{(2)})\)</span> since<br />
<span class="math display">\[u_1\geq u_2 \geq u_3,\  u = u_{(1)}=u_3\]</span> <span class="math display">\[u_1\geq u_3 \geq u_2,\ u=u_{(2)}=u_3\]</span> <span class="math display">\[u_2\geq u_1 \geq u_3,\ u = u_{(1)}=u_3\]</span> <span class="math display">\[u_2\geq u_3 \geq u_1,\ u= u_{(2)}=u_3\]</span> <span class="math display">\[u_3\geq u_2 \geq u_1,\ u= u_{(2)}=u_2\]</span> <span class="math display">\[u_3\geq u_1 \geq u_2,\ u= u_{(1)}=u_2\]</span> Let <span class="math inline">\(A\)</span> denote the events that <span class="math inline">\(u=u_{(1)}\)</span>, hence we get:</p>
<p><span class="math display">\[
\begin{aligned}
P(u\leq x) 
&amp;= P(A)P(u\leq x|A)+P(A^c)P(u\leq x|A^c)\\
&amp;= P(A)P(u_{(1)}\leq x)+P(A^c)P(u_{(2)}\leq x)\\
&amp;= \frac12 (\int_0^x 3(1-t)^2\mathrm{d}t + \int_0^x 6t(1-t)\mathrm{d}t)\\
&amp;= \frac32x - \frac12 x^3,\ (0&lt;x&lt;1)
\end{aligned}
\]</span> and <span class="math inline">\(\frac{\mathrm{d}P(u\leq x)}{\mathrm{d}x} = f_e\)</span>.</p>
</div>
<div id="section-2" class="section level3">
<h3>3.13</h3>
<p>Generate 1000 random observations from the mixture with <span class="math inline">\(r = 4\)</span> and <span class="math inline">\(\beta = 2\)</span>. Compare the empirical and theoretical (<span class="math inline">\(Pareto\)</span>) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># homework 3.13</span></span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb6-5"><a href="#cb6-5"></a></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co"># function that generates random numbers</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>generate &lt;-<span class="st"> </span><span class="cf">function</span>(n) {</span>
<span id="cb6-8"><a href="#cb6-8"></a>    result &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb6-9"><a href="#cb6-9"></a>    lambda &lt;-<span class="st"> </span><span class="kw">rgamma</span>(<span class="dt">n=</span>n, <span class="dt">shape=</span><span class="dv">4</span>, <span class="dt">rate=</span><span class="dv">2</span>)</span>
<span id="cb6-10"><a href="#cb6-10"></a>    result &lt;-<span class="st"> </span><span class="kw">rexp</span>(<span class="dt">n=</span>n, <span class="dt">rate=</span>lambda)</span>
<span id="cb6-11"><a href="#cb6-11"></a>    result</span>
<span id="cb6-12"><a href="#cb6-12"></a>}</span>
<span id="cb6-13"><a href="#cb6-13"></a></span>
<span id="cb6-14"><a href="#cb6-14"></a>b &lt;-<span class="st"> </span><span class="kw">generate</span>(<span class="dv">1000</span>)</span>
<span id="cb6-15"><a href="#cb6-15"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.2</span>, <span class="dv">6</span>, <span class="fl">0.2</span>)</span>
<span id="cb6-16"><a href="#cb6-16"></a>y &lt;-<span class="st"> </span><span class="dv">64</span><span class="op">*</span>(<span class="dv">2</span><span class="op">+</span>x)<span class="op">^</span>(<span class="op">-</span><span class="dv">5</span>)</span>
<span id="cb6-17"><a href="#cb6-17"></a></span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="co"># draw histogram and line</span></span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="kw">hist</span>(b, <span class="dt">freq=</span>F, <span class="dt">breaks=</span><span class="dv">50</span>)</span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="kw">lines</span>(x, y, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="homework-3" class="section level1">
<h1>HOMEWORK 3</h1>
<div id="section-3" class="section level2">
<h2>5.3</h2>
<p>Theoretical computation: <span class="math display">\[
\begin{aligned}
\int_0^{\pi/3}\sin{x}\mathrm{d}x &amp;=(-\cos{x})|^{\pi/3}_0\\
&amp;=-\frac12-(-1)\\
&amp;=\frac12
\end{aligned}
\]</span> Use Monte-Carlo method to compute the integration.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co"># generate random numbers</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="fl">1e5</span>, <span class="dv">0</span>, pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb7-5"><a href="#cb7-5"></a></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co"># use Monte-Carlo method to compute the integration</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>y &lt;-<span class="st"> </span><span class="kw">sin</span>(u)</span>
<span id="cb7-8"><a href="#cb7-8"></a>value &lt;-<span class="st"> </span>pi<span class="op">/</span><span class="dv">3</span><span class="op">*</span><span class="kw">mean</span>(y); value</span></code></pre></div>
<pre><code># [1] 0.4994595</code></pre>
</div>
<div id="section-4" class="section level2">
<h2>5.7</h2>
<p>Use Monte-Carlo method and Antithetic method to compute the integration respectively. And compare the empirical variance of the two methods.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb9-3"><a href="#cb9-3"></a></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co"># @Function used to compute integration</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co"># @Param anti:  if anti=TRUE use &quot;Antithetic&quot; method</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">#               otherwise use &quot;Monte-Carlo&quot; method.</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co"># @Param n:     number of random variates we generate  </span></span>
<span id="cb9-8"><a href="#cb9-8"></a>rate.phi &lt;-<span class="st"> </span><span class="cf">function</span>(n, <span class="dt">anti=</span><span class="ot">TRUE</span>) {</span>
<span id="cb9-9"><a href="#cb9-9"></a>    u &lt;-<span class="st"> </span><span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb9-10"><a href="#cb9-10"></a>    <span class="cf">if</span>(anti) u &lt;-<span class="st"> </span><span class="kw">c</span>(u, <span class="dv">1</span><span class="op">-</span>u) <span class="cf">else</span> u &lt;-<span class="st"> </span><span class="kw">c</span>(u, <span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb9-11"><a href="#cb9-11"></a>    x &lt;-<span class="st"> </span><span class="kw">exp</span>(u)</span>
<span id="cb9-12"><a href="#cb9-12"></a>    value1 &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb9-13"><a href="#cb9-13"></a>    value1</span>
<span id="cb9-14"><a href="#cb9-14"></a>}</span>
<span id="cb9-15"><a href="#cb9-15"></a></span>
<span id="cb9-16"><a href="#cb9-16"></a>m &lt;-<span class="st"> </span><span class="fl">1e3</span></span>
<span id="cb9-17"><a href="#cb9-17"></a>MC1 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="fl">0.</span>, m) </span>
<span id="cb9-18"><a href="#cb9-18"></a>MC2 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="fl">0.</span>, m) </span>
<span id="cb9-19"><a href="#cb9-19"></a></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb9-21"><a href="#cb9-21"></a>    MC1[i] &lt;-<span class="st"> </span><span class="kw">rate.phi</span>(<span class="fl">1e3</span>)</span>
<span id="cb9-22"><a href="#cb9-22"></a>    MC2[i] &lt;-<span class="st"> </span><span class="kw">rate.phi</span>(<span class="fl">1e3</span>, <span class="dt">anti=</span><span class="ot">FALSE</span>)</span>
<span id="cb9-23"><a href="#cb9-23"></a>}</span>
<span id="cb9-24"><a href="#cb9-24"></a></span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="co"># empirical percent reduction in variance using antithetic variate</span></span>
<span id="cb9-26"><a href="#cb9-26"></a><span class="kw">c</span>(<span class="kw">mean</span>(MC1), <span class="kw">mean</span>(MC2), <span class="kw">var</span>(MC1)<span class="op">/</span><span class="kw">var</span>(MC2))</span></code></pre></div>
<pre><code># [1] 1.71831521 1.71797868 0.03443972</code></pre>
<div id="theoretical-computation" class="section level3">
<h3>Theoretical computation</h3>
<p>Compute <span class="math inline">\(\mathbf{Cov}(e^u, e^{1-u})\)</span>: <span class="math display">\[
\mathbf{Cov}(e^u,e^{1-u})=E[e^ue^{1-u}]-E[e^u]E[e^{1-u}]=e-(e-1)^2=-e^2+3e-1
\]</span></p>
<p>Compute <span class="math inline">\(\mathbf{Var}((e^u+e^{1-u})/2)\)</span></p>
<p><span class="math display">\[
\mathbf{Var}(e^u)=E[e^{2u}]-E^2[e]=\int_0^1e^{2u}\mathrm{d}u-(e-1)^2=\frac12(-e^2+4e-3)
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
\mathbf{Var}(e^u+e^{1-u}) &amp;=\mathbf{Var}(e^u)+\mathbf{Var}(e^{1-u})+2\mathbf{Cov}(e^u,e^{1-u})\\
&amp;= 2\mathbf{Var}(e^u)+2\mathbf{Cov}(e^u,e^{1-u})\\
&amp;= -3e^2+10e-5
\end{aligned}
\]</span></p>
<p>Theoretical percent ruduction in variance: <span class="math display">\[
\frac{\mathbf{Var}((e^u+e^{1-u})/2)}{\mathbf{Var}(e^u)}=\frac{-3e^2+10e-5}{-2e^2+8e-6}
\]</span></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>e &lt;-<span class="st"> </span><span class="fl">2.718281828</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>theo.rate &lt;-<span class="st"> </span>(<span class="op">-</span><span class="dv">3</span><span class="op">*</span>e<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">10</span><span class="op">*</span>e<span class="dv">-5</span>)<span class="op">/</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>e<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">8</span><span class="op">*</span>e<span class="dv">-6</span>); theo.rate</span></code></pre></div>
<pre><code># [1] 0.01616497</code></pre>
</div>
</div>
<div id="section-5" class="section level2">
<h2>5.11</h2>
<p>It is easy to compute:</p>
<p><span class="math display">\[
\mathbf{Var}(c\hat{\theta}_1+(1-c)\hat{\theta}_2)=c^2\mathbf{Var}(\hat{\theta}_1-\hat{\theta}_2)+2c\mathbf{Cov}(\hat{\theta}_2,\hat{\theta}_1-\hat{\theta}_2)+\mathbf{Var}(\hat{\theta}_2)
\]</span></p>
<p>This is a quadratic function of <span class="math inline">\(c\)</span>, hence:</p>
<p><span class="math display">\[
c^*=-\frac{\mathbf{Cov}(\hat{\theta}_2,\hat{\theta}_1-\hat{\theta}_2)}{\mathbf{Var}(\hat{\theta}_1-\hat{\theta}_2)}=\frac{\mathbf{Var}(\hat{\theta}_2)-\mathbf{Cov}(\hat{\theta}_2,\hat{\theta}_1)}{\mathbf{Var}(\hat{\theta}_1)+\mathbf{Var}(\hat{\theta}_2)-2\mathbf{Cov}(\hat{\theta}_2,\hat{\theta}_1)}
\]</span></p>
</div>
</div>
<div id="homework-4" class="section level1">
<h1>HOMEWORK 4</h1>
<div id="question-2" class="section level2">
<h2>Question</h2>
<div id="section-6" class="section level3">
<h3>5.13</h3>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,+\infty)\)</span> and are ‘close’ to <span class="math display">\[g(x) = \frac{x^2}{\sqrt{2\pi}} e^{-\frac{x^2}2}, x &gt; 1.\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[ \int_1^\infty\frac{x^2}{\sqrt{2\pi}} e^{-\frac{x^2}2}\mathrm{d}x\]</span> by importance sampling? Explain.</p>
</div>
<div id="section-7" class="section level3">
<h3>5.15</h3>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
</div>
<div id="section-8" class="section level3">
<h3>6.4</h3>
<p>Suppose that <span class="math inline">\(X_1,\dots, X_n\)</span> are a random sample from a from a lognormal distribution with unknown parameters. Construct a <span class="math inline">\(95\%\)</span> confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p>
</div>
<div id="section-9" class="section level3">
<h3>6.5</h3>
<p>Suppose a <span class="math inline">\(95\%\)</span> symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to <span class="math inline">\(0.95\)</span>. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n = 20\)</span>. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div id="section-10" class="section level3">
<h3>5.13</h3>
<p>chose <span class="math display">\[f_1(x)=\frac2{\sqrt{2{\pi}}}e^{-\frac{(x-1)^2}{2}}, x&gt;1\]</span></p>
<p><span class="math display">\[\frac{g(x)}{f_1(x)}=\frac{x^2}2e^{-x+\frac12},x&gt;1\]</span></p>
<p>chose <span class="math display">\[f_2(x)=e^{-(x-1)}, x&gt;1\]</span></p>
<p><span class="math display">\[\frac{g(x)}{f_2(x)}=\frac{1}{\sqrt{2\pi}}x^2e^{-\frac{x^2}2+x-1},x&gt;1\]</span></p>
<p>From our simulation, it`s obvious that the chose <span class="math inline">\(f_1\)</span> as importance function we can get a smaller variance. It is the first importance function curve closer to <span class="math inline">\(g(x)\)</span>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb13-4"><a href="#cb13-4"></a>    <span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>(x<span class="op">^</span><span class="dv">2</span>))<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">1</span>)</span>
<span id="cb13-5"><a href="#cb13-5"></a>}</span>
<span id="cb13-6"><a href="#cb13-6"></a></span>
<span id="cb13-7"><a href="#cb13-7"></a>f1 &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb13-8"><a href="#cb13-8"></a>    <span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span>x<span class="fl">-0.5</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">1</span>)</span>
<span id="cb13-9"><a href="#cb13-9"></a>}</span>
<span id="cb13-10"><a href="#cb13-10"></a></span>
<span id="cb13-11"><a href="#cb13-11"></a>f2 &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb13-12"><a href="#cb13-12"></a>    <span class="kw">exp</span>(<span class="op">-</span>(x<span class="dv">-1</span>))<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">1</span>)</span>
<span id="cb13-13"><a href="#cb13-13"></a>}</span>
<span id="cb13-14"><a href="#cb13-14"></a></span>
<span id="cb13-15"><a href="#cb13-15"></a>n &lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="co"># generate samples from distribution f1</span></span>
<span id="cb13-17"><a href="#cb13-17"></a>u &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">rnorm</span>(n))<span class="op">+</span><span class="dv">1</span></span>
<span id="cb13-18"><a href="#cb13-18"></a>fg1 &lt;-<span class="kw">g</span>(u)<span class="op">/</span><span class="kw">f1</span>(u)</span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="co"># generate samples from distribution f2</span></span>
<span id="cb13-20"><a href="#cb13-20"></a>v &lt;-<span class="st"> </span><span class="kw">rexp</span>(n,<span class="dv">1</span>)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb13-21"><a href="#cb13-21"></a>fg2 &lt;-<span class="st"> </span><span class="kw">g</span>(v)<span class="op">/</span><span class="kw">f2</span>(v)</span>
<span id="cb13-22"><a href="#cb13-22"></a></span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="co"># estimation use importance function f1</span></span>
<span id="cb13-24"><a href="#cb13-24"></a><span class="kw">mean</span>(fg1)</span></code></pre></div>
<pre><code># [1] 0.4003573</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># estimation use importance function f2</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="kw">mean</span>(fg2)</span></code></pre></div>
<pre><code># [1] 0.4013249</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># the variance of the two estimations</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="kw">var</span>(fg1)</span></code></pre></div>
<pre><code># [1] 0.00195779</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">var</span>(fg2)</span></code></pre></div>
<pre><code># [1] 0.02513175</code></pre>
</div>
<div id="section-11" class="section level3">
<h3>5.15</h3>
<p>simply divide the interval <span class="math inline">\([0,1]\)</span> into 5 parts. Then on the <span class="math inline">\(j_{th}\)</span> subinterval variables are generated from the density: <span class="math display">\[f_k(x)=\frac{C_k}{1-e^{-1}}e^{-x},\frac{k-1}5&lt;x&lt;\frac k5\]</span> <span class="math inline">\(C_1=\)</span> 3.4871914,<span class="math inline">\(C_2=\)</span> 4.2592652,<span class="math inline">\(C_3=\)</span> 5.2022783,<span class="math inline">\(C_4=\)</span> 6.354077,<span class="math inline">\(C_5=\)</span> 7.7608872</p>
<p>Our integration can be write as:</p>
<p><span class="math display">\[
\int_0^1 g(x)\mathrm{d}x=\sum_{k=1}^5\int_{(k-1)/5}^{k/5} \frac{g(x)}{f_k(x)}f_k(x)d(x)
\]</span>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="kw">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb21-3"><a href="#cb21-3"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb21-4"><a href="#cb21-4"></a>    <span class="kw">exp</span>(<span class="op">-</span>x <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb21-5"><a href="#cb21-5"></a>}</span>
<span id="cb21-6"><a href="#cb21-6"></a></span>
<span id="cb21-7"><a href="#cb21-7"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x, k) {</span>
<span id="cb21-8"><a href="#cb21-8"></a>    C &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.2</span><span class="op">*</span>k<span class="fl">+0.2</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.2</span><span class="op">*</span>k))</span>
<span id="cb21-9"><a href="#cb21-9"></a>    C<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">*</span>(x<span class="op">&gt;</span>(<span class="fl">0.2</span><span class="op">*</span>k<span class="fl">-0.2</span>))<span class="op">*</span>(x<span class="op">&lt;</span>(<span class="fl">0.2</span><span class="op">*</span>k))</span>
<span id="cb21-10"><a href="#cb21-10"></a>}</span>
<span id="cb21-11"><a href="#cb21-11"></a></span>
<span id="cb21-12"><a href="#cb21-12"></a>rf &lt;-<span class="st"> </span><span class="cf">function</span>(m, k) {</span>
<span id="cb21-13"><a href="#cb21-13"></a>    C &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.2</span><span class="op">*</span>k<span class="fl">+0.2</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.2</span><span class="op">*</span>k))</span>
<span id="cb21-14"><a href="#cb21-14"></a>    u &lt;-<span class="st"> </span><span class="kw">runif</span>(m)</span>
<span id="cb21-15"><a href="#cb21-15"></a>    x &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.2</span><span class="op">*</span>k<span class="fl">+0.2</span>)<span class="op">-</span>u<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span>C)</span>
<span id="cb21-16"><a href="#cb21-16"></a>    x</span>
<span id="cb21-17"><a href="#cb21-17"></a>}</span>
<span id="cb21-18"><a href="#cb21-18"></a></span>
<span id="cb21-19"><a href="#cb21-19"></a>m=<span class="fl">2e4</span></span>
<span id="cb21-20"><a href="#cb21-20"></a>theta &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb21-21"><a href="#cb21-21"></a>var.theta &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb21-22"><a href="#cb21-22"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</span>
<span id="cb21-23"><a href="#cb21-23"></a>    v &lt;-<span class="st"> </span><span class="kw">rf</span>(m, k)</span>
<span id="cb21-24"><a href="#cb21-24"></a>    xx &lt;-<span class="st"> </span><span class="kw">g</span>(v)<span class="op">/</span><span class="kw">f</span>(v,k)</span>
<span id="cb21-25"><a href="#cb21-25"></a>    theta[k] &lt;-<span class="st"> </span><span class="kw">mean</span>(xx)</span>
<span id="cb21-26"><a href="#cb21-26"></a>    var.theta[k] &lt;-<span class="st"> </span><span class="kw">var</span>(xx)</span>
<span id="cb21-27"><a href="#cb21-27"></a>}</span>
<span id="cb21-28"><a href="#cb21-28"></a></span>
<span id="cb21-29"><a href="#cb21-29"></a><span class="co"># stratified importance sampling</span></span>
<span id="cb21-30"><a href="#cb21-30"></a><span class="kw">sum</span>(theta)</span></code></pre></div>
<pre><code># [1] 0.5248173</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="dv">5</span><span class="op">*</span><span class="kw">sum</span>(var.theta)</span></code></pre></div>
<pre><code># [1] 0.0003123022</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># importance sampling</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">5</span><span class="op">*</span>m) <span class="co">#inverse transform method</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>x &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb25-4"><a href="#cb25-4"></a>fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb25-5"><a href="#cb25-5"></a></span>
<span id="cb25-6"><a href="#cb25-6"></a><span class="kw">mean</span>(fg)</span></code></pre></div>
<pre><code># [1] 0.5244793</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">var</span>(fg)</span></code></pre></div>
<pre><code># [1] 0.009396823</code></pre>
</div>
<div id="section-12" class="section level3">
<h3>6.4</h3>
<p>If <span class="math inline">\(X\sim LN(\mu, \sigma^2)\)</span>, it`s easy to know that <span class="math inline">\(\log{X}\sim N(\mu, \sigma^2)\)</span>. If <span class="math inline">\(X_1,X_2,\dots,X_n,iid\sim LN(\mu,\sigma^2)\)</span>, let <span class="math inline">\(Y_i=\log{X_i}\)</span> <span class="math display">\[(\bar{Y}-\mu)/\hat{\sigma}\sim t_{n-1}\]</span> <span class="math inline">\(\hat{\sigma}^2=\frac1{n-1}\sum_{i=1}^n(Y_i-\bar{Y})^2\)</span>, <span class="math inline">\(\bar{Y}=\frac1n\sum_{i=1}^nY_i\)</span> so the <span class="math inline">\(1-\alpha\)</span> confidence interval of <span class="math inline">\(\mu\)</span> is: <span class="math display">\[[\bar{Y}-\hat{\sigma}t_{n-1}(1-\alpha/2), \bar{Y}+\hat{\sigma}t_{n-1}(1-\alpha/2)]\]</span></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb29-3"><a href="#cb29-3"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb29-4"><a href="#cb29-4"></a>m &lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb29-5"><a href="#cb29-5"></a>mu &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb29-6"><a href="#cb29-6"></a>sigma &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb29-7"><a href="#cb29-7"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb29-8"><a href="#cb29-8"></a>u &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb29-9"><a href="#cb29-9"></a>theta.hat &lt;-<span class="kw">data.frame</span>(<span class="dt">L=</span><span class="kw">numeric</span>(m), <span class="dt">U=</span><span class="kw">numeric</span>(m))</span>
<span id="cb29-10"><a href="#cb29-10"></a></span>
<span id="cb29-11"><a href="#cb29-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb29-12"><a href="#cb29-12"></a>    u &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(n, mu, sigma)</span>
<span id="cb29-13"><a href="#cb29-13"></a>    x &lt;-<span class="st"> </span><span class="kw">log</span>(u)</span>
<span id="cb29-14"><a href="#cb29-14"></a>    len &lt;-<span class="st"> </span><span class="kw">sd</span>(x)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, n<span class="dv">-1</span>)</span>
<span id="cb29-15"><a href="#cb29-15"></a>    theta.hat[i, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(x)<span class="op">-</span>len,<span class="kw">mean</span>(x)<span class="op">+</span>len)</span>
<span id="cb29-16"><a href="#cb29-16"></a>}</span>
<span id="cb29-17"><a href="#cb29-17"></a></span>
<span id="cb29-18"><a href="#cb29-18"></a><span class="co"># 95% confidence interval of parameter mu</span></span>
<span id="cb29-19"><a href="#cb29-19"></a><span class="co"># use Monte-Carlo method</span></span>
<span id="cb29-20"><a href="#cb29-20"></a><span class="kw">apply</span>(theta.hat,<span class="dv">2</span>,mean)</span></code></pre></div>
<pre><code>#         L         U 
# -1.067428  3.073620</code></pre>
</div>
<div id="section-13" class="section level3">
<h3>6.5</h3>
<p>Generate some samples from <span class="math inline">\(\chi^2(2)\)</span>, compute the t-interval. Then generate samples from <span class="math inline">\(\chi^2(2)\)</span>, compute the frequency of samples in the t-interval. Repeat the process m times, and the average of these frequencies is the Monte-Carlo coverage probability.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb31-3"><a href="#cb31-3"></a></span>
<span id="cb31-4"><a href="#cb31-4"></a>n &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb31-5"><a href="#cb31-5"></a>m &lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb31-6"><a href="#cb31-6"></a>alpha &lt;-<span class="fl">0.05</span></span>
<span id="cb31-7"><a href="#cb31-7"></a></span>
<span id="cb31-8"><a href="#cb31-8"></a>x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dv">2</span>)</span>
<span id="cb31-9"><a href="#cb31-9"></a>len &lt;-<span class="st"> </span><span class="kw">sd</span>(x)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, n<span class="dv">-1</span>)</span>
<span id="cb31-10"><a href="#cb31-10"></a><span class="co"># t-interval</span></span>
<span id="cb31-11"><a href="#cb31-11"></a>L &lt;-<span class="st"> </span><span class="kw">mean</span>(x)<span class="op">-</span>len; L</span></code></pre></div>
<pre><code># [1] -1.855659</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>U &lt;-<span class="st"> </span><span class="kw">mean</span>(x)<span class="op">+</span>len; U</span></code></pre></div>
<pre><code># [1] 5.464159</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>p.hat &lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb35-2"><a href="#cb35-2"></a></span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb35-4"><a href="#cb35-4"></a>    <span class="co"># generate samples from chi-square distribution with df=2</span></span>
<span id="cb35-5"><a href="#cb35-5"></a>    u &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dv">2</span>)</span>
<span id="cb35-6"><a href="#cb35-6"></a>    <span class="co"># frequency elements of u in [L, U]</span></span>
<span id="cb35-7"><a href="#cb35-7"></a>    p.hat[i] &lt;-<span class="st"> </span><span class="kw">sum</span>((u<span class="op">&gt;=</span>L)<span class="op">*</span>(u<span class="op">&lt;=</span>U))<span class="op">/</span>n</span>
<span id="cb35-8"><a href="#cb35-8"></a>}</span>
<span id="cb35-9"><a href="#cb35-9"></a></span>
<span id="cb35-10"><a href="#cb35-10"></a><span class="co"># coverage probability of the t-interval </span></span>
<span id="cb35-11"><a href="#cb35-11"></a><span class="kw">mean</span>(p.hat)</span></code></pre></div>
<pre><code># [1] 0.934834</code></pre>
</div>
</div>
</div>
<div id="homework-5" class="section level1">
<h1>HOMEWORK 5</h1>
<div id="question-3" class="section level2">
<h2>Question</h2>
<div id="section-14" class="section level3">
<h3>6.7</h3>
<p>Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(\alpha, \alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\nu)\)</span>?</p>
</div>
<div id="section-15" class="section level3">
<h3>6.8</h3>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the <span class="math inline">\(F\)</span> test of equal variance, at significance level <span class="math inline">\(\hat{\alpha}=0.055\)</span>. Compare the power of the Count Five test and <span class="math inline">\(F\)</span> test for small, medium, and large sample sizes. (Recall that the <span class="math inline">\(F\)</span> test is not applicable for non-normal distributions.)</p>
</div>
<div id="c" class="section level3">
<h3>6.C</h3>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math display">\[\beta_{1,d}=E[(X-\mu)^T\Sigma^{-1}(Y-\mu)]^3\]</span> Under normality, <span class="math inline">\(\beta_{1,d}=0\)</span>. The multivariate skewness statistic is <span class="math display">\[ b_{1,d}=\frac1{n^2}\sum_{i,j}^n\bigg[(X_i-\bar{X})^T\hat{\Sigma}^{-1}(X_j-\bar{X})\bigg]^3\]</span> where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d + 1)(d + 2)/6\)</span> degrees of freedom.</p>
</div>
<div id="discussion" class="section level3">
<h3>Discussion</h3>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<ol style="list-style-type: decimal">
<li><p>What is the corresponding hypothesis test problem?</p></li>
<li><p>What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</p></li>
<li><p>What information is needed to test your hypothesis?</p></li>
</ol>
</div>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div id="section-16" class="section level3">
<h3>6.7</h3>
<p>Repeat 2500 times to estimate the power of skewness test of normality against <span class="math inline">\(Beta(4,4)\)</span> and <span class="math inline">\(t(8)\)</span>. And the two powers are different because the <span class="math inline">\(Beta(4,4)\)</span> distribution is not symmetric while <span class="math inline">\(t(\nu)\)</span> distribution is symmetric distribution.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span>
<span id="cb37-2"><a href="#cb37-2"></a></span>
<span id="cb37-3"><a href="#cb37-3"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb37-4"><a href="#cb37-4"></a>    <span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb37-5"><a href="#cb37-5"></a>    xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb37-6"><a href="#cb37-6"></a>    m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb37-7"><a href="#cb37-7"></a>    m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb37-8"><a href="#cb37-8"></a>    <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb37-9"><a href="#cb37-9"></a>}</span>
<span id="cb37-10"><a href="#cb37-10"></a></span>
<span id="cb37-11"><a href="#cb37-11"></a>alpha &lt;-<span class="st"> </span><span class="fl">.05</span></span>
<span id="cb37-12"><a href="#cb37-12"></a>n &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb37-13"><a href="#cb37-13"></a>m &lt;-<span class="st"> </span><span class="dv">2500</span></span>
<span id="cb37-14"><a href="#cb37-14"></a></span>
<span id="cb37-15"><a href="#cb37-15"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb37-16"><a href="#cb37-16"></a><span class="co">#critical value for the skewness test</span></span>
<span id="cb37-17"><a href="#cb37-17"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb37-18"><a href="#cb37-18"></a></span>
<span id="cb37-19"><a href="#cb37-19"></a>sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb37-20"><a href="#cb37-20"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></span>
<span id="cb37-21"><a href="#cb37-21"></a>    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb37-22"><a href="#cb37-22"></a>    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb37-23"><a href="#cb37-23"></a>}</span>
<span id="cb37-24"><a href="#cb37-24"></a><span class="co"># power of the skewness test of normality</span></span>
<span id="cb37-25"><a href="#cb37-25"></a><span class="co"># against beta(4, 4)</span></span>
<span id="cb37-26"><a href="#cb37-26"></a>pwr[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb37-27"><a href="#cb37-27"></a></span>
<span id="cb37-28"><a href="#cb37-28"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></span>
<span id="cb37-29"><a href="#cb37-29"></a>    x &lt;-<span class="st"> </span><span class="kw">rt</span>(n, <span class="dv">8</span>)</span>
<span id="cb37-30"><a href="#cb37-30"></a>    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb37-31"><a href="#cb37-31"></a>}</span>
<span id="cb37-32"><a href="#cb37-32"></a><span class="co"># power of the skewness test of normality</span></span>
<span id="cb37-33"><a href="#cb37-33"></a><span class="co"># against t(8)</span></span>
<span id="cb37-34"><a href="#cb37-34"></a>pwr[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb37-35"><a href="#cb37-35"></a>pwr</span></code></pre></div>
<pre><code># [1] 0.016 0.160</code></pre>
</div>
<div id="section-17" class="section level3">
<h3>6.8</h3>
<p>For different sample size, estimate the powers of <code>count5test()</code> and <code>f.test()</code>. From our result, the power of F test is larger than that of count5test.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span>
<span id="cb39-2"><a href="#cb39-2"></a></span>
<span id="cb39-3"><a href="#cb39-3"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb39-4"><a href="#cb39-4"></a>    X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb39-5"><a href="#cb39-5"></a>    Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb39-6"><a href="#cb39-6"></a>    outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb39-7"><a href="#cb39-7"></a>    outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb39-8"><a href="#cb39-8"></a>    <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb39-9"><a href="#cb39-9"></a>    <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb39-10"><a href="#cb39-10"></a>}</span>
<span id="cb39-11"><a href="#cb39-11"></a></span>
<span id="cb39-12"><a href="#cb39-12"></a>f.test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, <span class="dt">alpha=</span><span class="fl">0.055</span>) {</span>
<span id="cb39-13"><a href="#cb39-13"></a>    N &lt;-<span class="st"> </span><span class="kw">length</span>(x)</span>
<span id="cb39-14"><a href="#cb39-14"></a>    M &lt;-<span class="st"> </span><span class="kw">length</span>(y)</span>
<span id="cb39-15"><a href="#cb39-15"></a>    F &lt;-<span class="st"> </span><span class="kw">var</span>(x)<span class="op">/</span><span class="kw">var</span>(y)</span>
<span id="cb39-16"><a href="#cb39-16"></a>    (F <span class="op">&lt;</span><span class="st"> </span><span class="kw">qf</span>(alpha<span class="op">/</span><span class="dv">2</span>, N<span class="dv">-1</span>, M<span class="dv">-1</span>))<span class="op">||</span>(F<span class="op">&gt;</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, N<span class="dv">-1</span>, M<span class="dv">-1</span>))</span>
<span id="cb39-17"><a href="#cb39-17"></a>}</span>
<span id="cb39-18"><a href="#cb39-18"></a></span>
<span id="cb39-19"><a href="#cb39-19"></a>m &lt;-<span class="st"> </span><span class="fl">1e3</span></span>
<span id="cb39-20"><a href="#cb39-20"></a><span class="co"># sample size for small, medium, large</span></span>
<span id="cb39-21"><a href="#cb39-21"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">50</span>, <span class="fl">1e3</span>)</span>
<span id="cb39-22"><a href="#cb39-22"></a><span class="co"># generate samples under H1 to estimate power</span></span>
<span id="cb39-23"><a href="#cb39-23"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb39-24"><a href="#cb39-24"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb39-25"><a href="#cb39-25"></a>power &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">ncol=</span><span class="dv">2</span>,<span class="dt">nrow=</span><span class="dv">3</span>)</span>
<span id="cb39-26"><a href="#cb39-26"></a></span>
<span id="cb39-27"><a href="#cb39-27"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){</span>
<span id="cb39-28"><a href="#cb39-28"></a>    power[j,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb39-29"><a href="#cb39-29"></a>        x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[j], <span class="dv">0</span>, sigma1)</span>
<span id="cb39-30"><a href="#cb39-30"></a>        y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[j], <span class="dv">0</span>, sigma2)</span>
<span id="cb39-31"><a href="#cb39-31"></a>        <span class="kw">count5test</span>(x, y)</span>
<span id="cb39-32"><a href="#cb39-32"></a>    }))</span>
<span id="cb39-33"><a href="#cb39-33"></a></span>
<span id="cb39-34"><a href="#cb39-34"></a>    power[j, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb39-35"><a href="#cb39-35"></a>        x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[j], <span class="dv">0</span>, sigma1)</span>
<span id="cb39-36"><a href="#cb39-36"></a>        y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[j], <span class="dv">0</span>, sigma2)</span>
<span id="cb39-37"><a href="#cb39-37"></a>        <span class="kw">f.test</span>(x, y)</span>
<span id="cb39-38"><a href="#cb39-38"></a>    }))</span>
<span id="cb39-39"><a href="#cb39-39"></a>}</span>
<span id="cb39-40"><a href="#cb39-40"></a></span>
<span id="cb39-41"><a href="#cb39-41"></a>power</span></code></pre></div>
<pre><code>#       [,1]  [,2]
# [1,] 0.117 0.195
# [2,] 0.663 0.827
# [3,] 0.997 1.000</code></pre>
</div>
<div id="c-1" class="section level3">
<h3>6.C</h3>
<p>Implement the Mardia test function, and replace <code>sk()</code> with <code>mardia.test()</code>. Since their distributions are different, we should compare the p-value with test level <span class="math inline">\(\alpha\)</span> when we use <code>mardia.test()</code>.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="kw">library</span>(MASS)</span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="co"># set.seed(124)</span></span>
<span id="cb41-4"><a href="#cb41-4"></a>mardia.test &lt;-<span class="st"> </span><span class="cf">function</span>(x,<span class="dt">alpha=</span><span class="fl">0.05</span>) {</span>
<span id="cb41-5"><a href="#cb41-5"></a>    m &lt;-<span class="st"> </span><span class="kw">nrow</span>(x)</span>
<span id="cb41-6"><a href="#cb41-6"></a>    p &lt;-<span class="st"> </span><span class="kw">ncol</span>(x)</span>
<span id="cb41-7"><a href="#cb41-7"></a>    var.hat &lt;-<span class="st"> </span><span class="kw">var</span>(x)<span class="op">*</span>(m<span class="dv">-1</span>)<span class="op">/</span>m</span>
<span id="cb41-8"><a href="#cb41-8"></a>    inve &lt;-<span class="st"> </span><span class="kw">solve</span>(var.hat)</span>
<span id="cb41-9"><a href="#cb41-9"></a>    ave &lt;-<span class="st"> </span><span class="kw">apply</span>(x, <span class="dv">2</span>, mean)</span>
<span id="cb41-10"><a href="#cb41-10"></a>    mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(ave, m), <span class="dt">ncol=</span>p,<span class="dt">byrow =</span> <span class="ot">TRUE</span>)</span>
<span id="cb41-11"><a href="#cb41-11"></a>    x &lt;-<span class="st"> </span>x<span class="op">-</span>mat</span>
<span id="cb41-12"><a href="#cb41-12"></a>    S &lt;-<span class="st"> </span>x<span class="op">%*%</span>inve<span class="op">%*%</span><span class="kw">t</span>(x)</span>
<span id="cb41-13"><a href="#cb41-13"></a>    M &lt;-<span class="st"> </span><span class="kw">sum</span>(S<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span>(m<span class="op">*</span><span class="dv">6</span>)</span>
<span id="cb41-14"><a href="#cb41-14"></a>    degree &lt;-<span class="st"> </span>p<span class="op">*</span>(p<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(p<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span></span>
<span id="cb41-15"><a href="#cb41-15"></a>    <span class="kw">pchisq</span>(M, degree)</span>
<span id="cb41-16"><a href="#cb41-16"></a>}</span>
<span id="cb41-17"><a href="#cb41-17"></a></span>
<span id="cb41-18"><a href="#cb41-18"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>) <span class="co"># sample sizes</span></span>
<span id="cb41-19"><a href="#cb41-19"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span> <span class="co">#</span></span>
<span id="cb41-20"><a href="#cb41-20"></a>p.reject &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n)) <span class="co"># to store sim. results</span></span>
<span id="cb41-21"><a href="#cb41-21"></a>mm &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co"># num. repl. each sim.</span></span>
<span id="cb41-22"><a href="#cb41-22"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</span>
<span id="cb41-23"><a href="#cb41-23"></a>    sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(mm) <span class="co"># test decisions</span></span>
<span id="cb41-24"><a href="#cb41-24"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>mm) {</span>
<span id="cb41-25"><a href="#cb41-25"></a>        x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">mvrnorm</span>(n[i], <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.3</span>,<span class="fl">0.3</span>,<span class="fl">1.5</span>),<span class="dt">ncol=</span><span class="dv">2</span>)))</span>
<span id="cb41-26"><a href="#cb41-26"></a>        <span class="co"># test decision is 1 (reject) or 0</span></span>
<span id="cb41-27"><a href="#cb41-27"></a>        sktests[j] &lt;-<span class="st"> </span>((<span class="kw">mardia.test</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>alpha) )</span>
<span id="cb41-28"><a href="#cb41-28"></a>    }</span>
<span id="cb41-29"><a href="#cb41-29"></a>    p.reject[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests) <span class="co"># proportion rejected</span></span>
<span id="cb41-30"><a href="#cb41-30"></a>}</span>
<span id="cb41-31"><a href="#cb41-31"></a>p.reject</span></code></pre></div>
<pre><code># [1] 0.005 0.029 0.029 0.039 0.055 0.048</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="kw">library</span>(MASS)</span>
<span id="cb43-3"><a href="#cb43-3"></a>mardia.test &lt;-<span class="st"> </span><span class="cf">function</span>(x,<span class="dt">alpha=</span><span class="fl">0.05</span>) {</span>
<span id="cb43-4"><a href="#cb43-4"></a>    m &lt;-<span class="st"> </span><span class="kw">nrow</span>(x)</span>
<span id="cb43-5"><a href="#cb43-5"></a>    p &lt;-<span class="st"> </span><span class="kw">ncol</span>(x)</span>
<span id="cb43-6"><a href="#cb43-6"></a>    <span class="co"># mle of covariance matrix</span></span>
<span id="cb43-7"><a href="#cb43-7"></a>    var.hat &lt;-<span class="st"> </span><span class="kw">var</span>(x)<span class="op">*</span>(m<span class="dv">-1</span>)<span class="op">/</span>m</span>
<span id="cb43-8"><a href="#cb43-8"></a>    inve &lt;-<span class="st"> </span><span class="kw">solve</span>(var.hat)</span>
<span id="cb43-9"><a href="#cb43-9"></a>    ave &lt;-<span class="st"> </span><span class="kw">apply</span>(x, <span class="dv">2</span>, mean)</span>
<span id="cb43-10"><a href="#cb43-10"></a>    mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(ave, m), <span class="dt">ncol=</span>p,<span class="dt">byrow =</span> <span class="ot">TRUE</span>)</span>
<span id="cb43-11"><a href="#cb43-11"></a>    x &lt;-<span class="st"> </span>x<span class="op">-</span>mat</span>
<span id="cb43-12"><a href="#cb43-12"></a>    S &lt;-<span class="st"> </span>x<span class="op">%*%</span>inve<span class="op">%*%</span><span class="kw">t</span>(x)</span>
<span id="cb43-13"><a href="#cb43-13"></a>    <span class="co"># compute mardia statistic</span></span>
<span id="cb43-14"><a href="#cb43-14"></a>    M &lt;-<span class="st"> </span><span class="kw">sum</span>(S<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span>(m<span class="op">*</span><span class="dv">6</span>)</span>
<span id="cb43-15"><a href="#cb43-15"></a>    <span class="co"># degree of freedom of asymptotic distribution</span></span>
<span id="cb43-16"><a href="#cb43-16"></a>    degree &lt;-<span class="st"> </span>p<span class="op">*</span>(p<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(p<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span></span>
<span id="cb43-17"><a href="#cb43-17"></a>    <span class="co"># p-value of the mardia statistic</span></span>
<span id="cb43-18"><a href="#cb43-18"></a>    <span class="kw">pchisq</span>(M, degree)</span>
<span id="cb43-19"><a href="#cb43-19"></a>}</span>
<span id="cb43-20"><a href="#cb43-20"></a></span>
<span id="cb43-21"><a href="#cb43-21"></a>alpha &lt;-<span class="st"> </span><span class="fl">.1</span></span>
<span id="cb43-22"><a href="#cb43-22"></a>n &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb43-23"><a href="#cb43-23"></a>mm &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb43-24"><a href="#cb43-24"></a>epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="fl">0.0</span>, <span class="fl">.15</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">15</span>, <span class="fl">0.95</span>, <span class="fl">.05</span>))</span>
<span id="cb43-25"><a href="#cb43-25"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</span>
<span id="cb43-26"><a href="#cb43-26"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb43-27"><a href="#cb43-27"></a><span class="co">#critical value for the skewness test</span></span>
<span id="cb43-28"><a href="#cb43-28"></a></span>
<span id="cb43-29"><a href="#cb43-29"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></span>
<span id="cb43-30"><a href="#cb43-30"></a>    e &lt;-<span class="st"> </span>epsilon[j]</span>
<span id="cb43-31"><a href="#cb43-31"></a>    sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(mm)</span>
<span id="cb43-32"><a href="#cb43-32"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>mm) { <span class="co">#for each replicate</span></span>
<span id="cb43-33"><a href="#cb43-33"></a>        sig &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</span>
<span id="cb43-34"><a href="#cb43-34"></a>        n1 &lt;-<span class="st"> </span><span class="kw">sum</span>(sig)</span>
<span id="cb43-35"><a href="#cb43-35"></a>        n2 &lt;-<span class="st"> </span>n <span class="op">-</span><span class="st"> </span>n1</span>
<span id="cb43-36"><a href="#cb43-36"></a>        x1 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n, <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.3</span>,<span class="fl">0.3</span>,<span class="fl">1.5</span>),<span class="dt">ncol=</span><span class="dv">2</span>))</span>
<span id="cb43-37"><a href="#cb43-37"></a>        x2 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n, <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">10</span>,<span class="fl">0.3</span>,<span class="fl">0.3</span>,<span class="dv">15</span>),<span class="dt">ncol=</span><span class="dv">2</span>))</span>
<span id="cb43-38"><a href="#cb43-38"></a>        x &lt;-<span class="st"> </span><span class="kw">rbind</span>(x1[<span class="dv">1</span><span class="op">:</span>n1,],x2[<span class="dv">1</span><span class="op">:</span>n2,])</span>
<span id="cb43-39"><a href="#cb43-39"></a>        sktests[i] &lt;-<span class="st"> </span>((<span class="kw">mardia.test</span>(x)) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span><span class="op">-</span>alpha)</span>
<span id="cb43-40"><a href="#cb43-40"></a>    }</span>
<span id="cb43-41"><a href="#cb43-41"></a>    pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb43-42"><a href="#cb43-42"></a>}</span>
<span id="cb43-43"><a href="#cb43-43"></a><span class="co">#plot power vs epsilon</span></span>
<span id="cb43-44"><a href="#cb43-44"></a><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb43-45"><a href="#cb43-45"></a>     <span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb43-46"><a href="#cb43-46"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb43-47"><a href="#cb43-47"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>mm) <span class="co">#add standard errors</span></span>
<span id="cb43-48"><a href="#cb43-48"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb43-49"><a href="#cb43-49"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="discussion-1" class="section level3">
<h3>Discussion</h3>
<p>-1 The corresponding test is:</p>
<p><span class="math inline">\(H_0\)</span>:the powers are same <span class="math inline">\(H_1\)</span>:the powers are different</p>
<p>-2 We should use paired t-test.</p>
<p>-3 We need the data in each experiment whether the two tests reject the null hypothesis. 1 denotes reject the null hypothesis and 0 denotes don`t reject the null hypothesis. If we have these data for the two tests stored in <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, we can use paired t-test.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span>
<span id="cb44-2"><a href="#cb44-2"></a>n &lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb44-3"><a href="#cb44-3"></a></span>
<span id="cb44-4"><a href="#cb44-4"></a>X &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">size=</span>n, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.349</span>, <span class="fl">0.651</span>))</span>
<span id="cb44-5"><a href="#cb44-5"></a>Y &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">size=</span>n, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.324</span>, <span class="fl">0.676</span>))</span>
<span id="cb44-6"><a href="#cb44-6"></a>minu &lt;-<span class="st"> </span>(X<span class="op">-</span>Y)</span>
<span id="cb44-7"><a href="#cb44-7"></a><span class="kw">t.test</span>(minu,<span class="dt">conf.level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<pre><code># 
#   One Sample t-test
# 
# data:  minu
# t = -4.8577, df = 9999, p-value = 1.206e-06
# alternative hypothesis: true mean is not equal to 0
# 95 percent confidence interval:
#  -0.04575501 -0.01944499
# sample estimates:
# mean of x 
#   -0.0326</code></pre>
</div>
</div>
</div>
<div id="homework-6" class="section level1">
<h1>HOMEWORK 6</h1>
<div id="question-4" class="section level2">
<h2>Question</h2>
<div id="section-18" class="section level3">
<h3>7.1</h3>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="section-19" class="section level3">
<h3>7.5</h3>
<p>Refer to Exercise 7.4. Compute <span class="math inline">\(95\%\)</span> bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
</div>
<div id="section-20" class="section level3">
<h3>7.8</h3>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat\theta\)</span>.</p>
</div>
<div id="section-21" class="section level3">
<h3>7.11</h3>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div id="section-22" class="section level3">
<h3>7.1</h3>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb46-2"><a href="#cb46-2"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(law)</span>
<span id="cb46-3"><a href="#cb46-3"></a>theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb46-4"><a href="#cb46-4"></a></span>
<span id="cb46-5"><a href="#cb46-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb46-6"><a href="#cb46-6"></a>    data &lt;-<span class="st"> </span>law[<span class="op">-</span>i,]</span>
<span id="cb46-7"><a href="#cb46-7"></a>    theta.jack[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(data[,<span class="dv">1</span>],data[,<span class="dv">2</span>])</span>
<span id="cb46-8"><a href="#cb46-8"></a>}</span>
<span id="cb46-9"><a href="#cb46-9"></a></span>
<span id="cb46-10"><a href="#cb46-10"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">cor</span>(law[,<span class="dv">1</span>],law[,<span class="dv">2</span>])</span>
<span id="cb46-11"><a href="#cb46-11"></a></span>
<span id="cb46-12"><a href="#cb46-12"></a><span class="co"># estimate bias of theta.hat using jackknife method</span></span>
<span id="cb46-13"><a href="#cb46-13"></a>bias.jack &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat); <span class="kw">round</span>(bias.jack,<span class="dv">4</span>)</span></code></pre></div>
<pre><code># [1] -0.0065</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="co"># estimate standard error of theta.hat using jackknife method</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>se.jack &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">var</span>(theta.jack)<span class="op">/</span>n); <span class="kw">round</span>(se.jack,<span class="dv">4</span>)</span></code></pre></div>
<pre><code># [1] 0.1425</code></pre>
</div>
<div id="section-23" class="section level3">
<h3>7.5</h3>
<p>Since <span class="math inline">\(E[X]=\frac 1{\lambda}\)</span>, we can estimate <span class="math inline">\(\lambda\)</span> using <span class="math inline">\(\hat\lambda=1/{\bar X}\)</span>. Then compute the <span class="math inline">\(95\%\)</span> bootstrap confidence interval.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb50-2"><a href="#cb50-2"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb50-3"><a href="#cb50-3"></a>data &lt;-<span class="st"> </span>aircondit</span>
<span id="cb50-4"><a href="#cb50-4"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb50-5"><a href="#cb50-5"></a></span>
<span id="cb50-6"><a href="#cb50-6"></a>N &lt;-<span class="st"> </span><span class="fl">1e3</span></span>
<span id="cb50-7"><a href="#cb50-7"></a></span>
<span id="cb50-8"><a href="#cb50-8"></a>est &lt;-<span class="st"> </span><span class="cf">function</span>(dat, ind) {</span>
<span id="cb50-9"><a href="#cb50-9"></a>    <span class="dv">1</span><span class="op">/</span><span class="kw">mean</span>(dat[ind,<span class="dv">1</span>])</span>
<span id="cb50-10"><a href="#cb50-10"></a>}</span>
<span id="cb50-11"><a href="#cb50-11"></a></span>
<span id="cb50-12"><a href="#cb50-12"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>data,<span class="dt">statistic =</span> est,<span class="dt">R=</span>N)</span>
<span id="cb50-13"><a href="#cb50-13"></a><span class="kw">boot.ci</span>(boot.obj,<span class="dt">conf=</span><span class="dv">1</span><span class="op">-</span>alpha,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;basic&quot;</span>, <span class="st">&quot;norm&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<pre><code># BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
# Based on 1000 bootstrap replicates
# 
# CALL : 
# boot.ci(boot.out = boot.obj, conf = 1 - alpha, type = c(&quot;basic&quot;, 
#     &quot;norm&quot;, &quot;perc&quot;, &quot;bca&quot;))
# 
# Intervals : 
# Level      Normal              Basic         
# 95%   (-0.0005,  0.0160 )   (-0.0024,  0.0131 )  
# 
# Level     Percentile            BCa          
# 95%   ( 0.0055,  0.0209 )   ( 0.0047,  0.0178 )  
# Calculations and Intervals on Original Scale
# Some BCa intervals may be unstable</code></pre>
<p>These methods are different because the distribution of statistics they use are different.</p>
</div>
<div id="section-24" class="section level3">
<h3>7.8</h3>
<p>Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat\theta\)</span>.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span>
<span id="cb52-2"><a href="#cb52-2"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb52-3"><a href="#cb52-3"></a>data &lt;-<span class="st"> </span>scor</span>
<span id="cb52-4"><a href="#cb52-4"></a></span>
<span id="cb52-5"><a href="#cb52-5"></a>estim &lt;-<span class="st"> </span><span class="cf">function</span> (dat) {</span>
<span id="cb52-6"><a href="#cb52-6"></a>  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(dat)</span>
<span id="cb52-7"><a href="#cb52-7"></a>  sig &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">var</span>(dat)<span class="op">/</span>n</span>
<span id="cb52-8"><a href="#cb52-8"></a>  vs &lt;-<span class="st"> </span><span class="kw">eigen</span>(sig)</span>
<span id="cb52-9"><a href="#cb52-9"></a>  lambdas &lt;-<span class="st"> </span>vs<span class="op">$</span>values</span>
<span id="cb52-10"><a href="#cb52-10"></a>  lambdas[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lambdas)</span>
<span id="cb52-11"><a href="#cb52-11"></a>}</span>
<span id="cb52-12"><a href="#cb52-12"></a></span>
<span id="cb52-13"><a href="#cb52-13"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(data)</span>
<span id="cb52-14"><a href="#cb52-14"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">estim</span>(data)</span>
<span id="cb52-15"><a href="#cb52-15"></a>theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb52-16"><a href="#cb52-16"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb52-17"><a href="#cb52-17"></a>  x &lt;-<span class="st"> </span>data[<span class="op">-</span>i,]</span>
<span id="cb52-18"><a href="#cb52-18"></a>    theta.jack[i] &lt;-<span class="st"> </span><span class="kw">estim</span>(x)</span>
<span id="cb52-19"><a href="#cb52-19"></a>}</span>
<span id="cb52-20"><a href="#cb52-20"></a></span>
<span id="cb52-21"><a href="#cb52-21"></a><span class="co"># estimate the bias of theta.hat using jackknife method</span></span>
<span id="cb52-22"><a href="#cb52-22"></a>bias.jack &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat); <span class="kw">round</span>(bias.jack,<span class="dv">4</span>)</span></code></pre></div>
<pre><code># [1] 0.0011</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="co"># estimate the standard error using jackknife method</span></span>
<span id="cb54-2"><a href="#cb54-2"></a>se.jack &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">var</span>(theta.jack)<span class="op">/</span>n); <span class="kw">round</span>(se.jack,<span class="dv">4</span>)</span></code></pre></div>
<pre><code># [1] 0.0496</code></pre>
</div>
<div id="section-25" class="section level3">
<h3>7.11</h3>
<p>Divide the data set into <span class="math inline">\(N\)</span> groups which makes every group contain two data points. Leave one group out and use the other <span class="math inline">\(N-1\)</span> groups to train.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span>
<span id="cb56-2"><a href="#cb56-2"></a><span class="kw">library</span>(DAAG); <span class="kw">attach</span>(ironslag)</span>
<span id="cb56-3"><a href="#cb56-3"></a>a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="fl">.1</span>) <span class="co">#sequence for plotting fits</span></span>
<span id="cb56-4"><a href="#cb56-4"></a>L1 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical)</span>
<span id="cb56-5"><a href="#cb56-5"></a>yhat1 &lt;-<span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a</span>
<span id="cb56-6"><a href="#cb56-6"></a></span>
<span id="cb56-7"><a href="#cb56-7"></a>L2 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb56-8"><a href="#cb56-8"></a>yhat2 &lt;-<span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span></span>
<span id="cb56-9"><a href="#cb56-9"></a></span>
<span id="cb56-10"><a href="#cb56-10"></a>L3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span>chemical)</span>
<span id="cb56-11"><a href="#cb56-11"></a>logyhat3 &lt;-<span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a</span>
<span id="cb56-12"><a href="#cb56-12"></a>yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</span>
<span id="cb56-13"><a href="#cb56-13"></a></span>
<span id="cb56-14"><a href="#cb56-14"></a>L4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(chemical))</span>
<span id="cb56-15"><a href="#cb56-15"></a>logyhat4 &lt;-<span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(a)</span>
<span id="cb56-16"><a href="#cb56-16"></a></span>
<span id="cb56-17"><a href="#cb56-17"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb56-18"><a href="#cb56-18"></a></span>
<span id="cb56-19"><a href="#cb56-19"></a><span class="co"># divide the data into to N groups</span></span>
<span id="cb56-20"><a href="#cb56-20"></a><span class="co"># each group contains two data point</span></span>
<span id="cb56-21"><a href="#cb56-21"></a>N &lt;-<span class="st"> </span><span class="kw">round</span>(n<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb56-22"><a href="#cb56-22"></a>e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>N, <span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb56-23"><a href="#cb56-23"></a>num &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n,<span class="dv">2</span><span class="op">*</span>N),<span class="dt">ncol=</span><span class="dv">2</span>,<span class="dt">nrow=</span>N)</span>
<span id="cb56-24"><a href="#cb56-24"></a></span>
<span id="cb56-25"><a href="#cb56-25"></a><span class="co"># for N-fold cross validation</span></span>
<span id="cb56-26"><a href="#cb56-26"></a><span class="co"># fit models on leave-two-out samples</span></span>
<span id="cb56-27"><a href="#cb56-27"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb56-28"><a href="#cb56-28"></a>    y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>num[k,]]</span>
<span id="cb56-29"><a href="#cb56-29"></a>    x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>num[k,]]</span>
<span id="cb56-30"><a href="#cb56-30"></a>    J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb56-31"><a href="#cb56-31"></a>    yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[num[k,]]</span>
<span id="cb56-32"><a href="#cb56-32"></a>    e1[k,] &lt;-<span class="st"> </span>magnetic[num[k]] <span class="op">-</span><span class="st"> </span>yhat1</span>
<span id="cb56-33"><a href="#cb56-33"></a>    J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb56-34"><a href="#cb56-34"></a>    yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[num[k,]] <span class="op">+</span></span>
<span id="cb56-35"><a href="#cb56-35"></a><span class="st">        </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[num[k,]]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb56-36"><a href="#cb56-36"></a>    e2[k,] &lt;-<span class="st"> </span>magnetic[num[k,]] <span class="op">-</span><span class="st"> </span>yhat2</span>
<span id="cb56-37"><a href="#cb56-37"></a>    J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb56-38"><a href="#cb56-38"></a>    logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[num[k,]]</span>
<span id="cb56-39"><a href="#cb56-39"></a>    yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</span>
<span id="cb56-40"><a href="#cb56-40"></a>    e3[k,] &lt;-<span class="st"> </span>magnetic[num[k,<span class="dv">1</span>]] <span class="op">-</span><span class="st"> </span>yhat3</span>
<span id="cb56-41"><a href="#cb56-41"></a>    J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</span>
<span id="cb56-42"><a href="#cb56-42"></a>    logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[num[k,]])</span>
<span id="cb56-43"><a href="#cb56-43"></a>    yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)</span>
<span id="cb56-44"><a href="#cb56-44"></a>    e4[k,] &lt;-<span class="st"> </span>magnetic[num[k,]] <span class="op">-</span><span class="st"> </span>yhat4</span>
<span id="cb56-45"><a href="#cb56-45"></a>}</span>
<span id="cb56-46"><a href="#cb56-46"></a><span class="kw">lapply</span>(<span class="kw">list</span>(e1,e2,e3,e4), <span class="cf">function</span>(x) {</span>
<span id="cb56-47"><a href="#cb56-47"></a>  a &lt;-<span class="st"> </span><span class="kw">apply</span>(x<span class="op">^</span><span class="dv">2</span>,<span class="dv">1</span>,sum)</span>
<span id="cb56-48"><a href="#cb56-48"></a>  <span class="kw">mean</span>(a)</span>
<span id="cb56-49"><a href="#cb56-49"></a>})</span></code></pre></div>
<pre><code># [[1]]
# [1] 87.01746
# 
# [[2]]
# [1] 36.93266
# 
# [[3]]
# [1] 78.57753
# 
# [[4]]
# [1] 41.2837</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="kw">detach</span>(ironslag)</span></code></pre></div>
<p>According to the prediction error criterion, Model 2, the quadratic model, would be the best fit for the data.</p>
</div>
</div>
</div>
<div id="homework-7" class="section level1">
<h1>HOMEWORK 7</h1>
<div id="question-5" class="section level2">
<h2>Question</h2>
<div id="section-26" class="section level3">
<h3>1.</h3>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="section-27" class="section level3">
<h3>2.</h3>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<ol style="list-style-type: decimal">
<li><p>Unequal variances and equal expectations</p></li>
<li><p>Unequal variances and unequal expectations</p></li>
<li><p>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p></li>
<li><p>Unbalanced samples (say, 1 case versus 10 controls)</p></li>
</ol>
<p>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p>
</div>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div id="section-28" class="section level3">
<h3>1.</h3>
<p>Use permutation method to promote count5 test.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span>
<span id="cb59-2"><a href="#cb59-2"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb59-3"><a href="#cb59-3"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb59-4"><a href="#cb59-4"></a>    X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb59-5"><a href="#cb59-5"></a>    Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb59-6"><a href="#cb59-6"></a>    outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb59-7"><a href="#cb59-7"></a>    outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb59-8"><a href="#cb59-8"></a>    <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb59-9"><a href="#cb59-9"></a>    <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb59-10"><a href="#cb59-10"></a>}</span>
<span id="cb59-11"><a href="#cb59-11"></a></span>
<span id="cb59-12"><a href="#cb59-12"></a>permutation &lt;-<span class="st"> </span><span class="cf">function</span>(z, <span class="dt">R=</span><span class="fl">1e3</span>) {</span>
<span id="cb59-13"><a href="#cb59-13"></a>    N =<span class="st"> </span><span class="kw">length</span>(z)</span>
<span id="cb59-14"><a href="#cb59-14"></a>    s =<span class="st"> </span><span class="kw">replicate</span>(R,{</span>
<span id="cb59-15"><a href="#cb59-15"></a>    idx =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>N, N<span class="op">/</span><span class="dv">2</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb59-16"><a href="#cb59-16"></a>    x =<span class="st"> </span>z[idx]</span>
<span id="cb59-17"><a href="#cb59-17"></a>    y =<span class="st"> </span>z[<span class="op">-</span>idx]</span>
<span id="cb59-18"><a href="#cb59-18"></a>    <span class="kw">count5test</span>(x,y)</span>
<span id="cb59-19"><a href="#cb59-19"></a>    })</span>
<span id="cb59-20"><a href="#cb59-20"></a>    <span class="kw">mean</span>(s)</span>
<span id="cb59-21"><a href="#cb59-21"></a>}</span>
<span id="cb59-22"><a href="#cb59-22"></a></span>
<span id="cb59-23"><a href="#cb59-23"></a>n1 &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb59-24"><a href="#cb59-24"></a>n2 &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb59-25"><a href="#cb59-25"></a>N &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb59-26"><a href="#cb59-26"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb59-27"><a href="#cb59-27"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb59-28"><a href="#cb59-28"></a>sigma2 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb59-29"><a href="#cb59-29"></a>m &lt;-<span class="st"> </span><span class="fl">1e3</span></span>
<span id="cb59-30"><a href="#cb59-30"></a></span>
<span id="cb59-31"><a href="#cb59-31"></a><span class="co"># use permutation</span></span>
<span id="cb59-32"><a href="#cb59-32"></a>permutation.test &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr =</span> {</span>
<span id="cb59-33"><a href="#cb59-33"></a>    x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb59-34"><a href="#cb59-34"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb59-35"><a href="#cb59-35"></a>    x &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb59-36"><a href="#cb59-36"></a>    y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb59-37"><a href="#cb59-37"></a>    z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</span>
<span id="cb59-38"><a href="#cb59-38"></a>    <span class="kw">permutation</span>(z)</span>
<span id="cb59-39"><a href="#cb59-39"></a>} )</span>
<span id="cb59-40"><a href="#cb59-40"></a></span>
<span id="cb59-41"><a href="#cb59-41"></a>count5.test &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr =</span> {</span>
<span id="cb59-42"><a href="#cb59-42"></a>    x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb59-43"><a href="#cb59-43"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb59-44"><a href="#cb59-44"></a>    x &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb59-45"><a href="#cb59-45"></a>    y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb59-46"><a href="#cb59-46"></a>    <span class="kw">count5test</span>(x,y)</span>
<span id="cb59-47"><a href="#cb59-47"></a>} )</span>
<span id="cb59-48"><a href="#cb59-48"></a></span>
<span id="cb59-49"><a href="#cb59-49"></a></span>
<span id="cb59-50"><a href="#cb59-50"></a><span class="kw">mean</span>(permutation.test<span class="op">&lt;</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code># [1] 0.037</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="kw">mean</span>(count5.test)</span></code></pre></div>
<pre><code># [1] 0.313</code></pre>
</div>
<div id="section-29" class="section level3">
<h3>2.</h3>
<p>evaluating the performance of the NN, energy, and ball methods in various situations. Use unequal variances, unequal variances and unequal expectations, t-distribution and bimodel distribution, unbalanced samples.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span>
<span id="cb63-2"><a href="#cb63-2"></a><span class="kw">library</span>(energy); <span class="kw">library</span>(Ball); <span class="kw">library</span>(boot)</span>
<span id="cb63-3"><a href="#cb63-3"></a><span class="kw">library</span>(MASS); <span class="kw">library</span>(RANN)</span>
<span id="cb63-4"><a href="#cb63-4"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb63-5"><a href="#cb63-5"></a></span>
<span id="cb63-6"><a href="#cb63-6"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb63-7"><a href="#cb63-7"></a>    n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb63-8"><a href="#cb63-8"></a>    <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb63-9"><a href="#cb63-9"></a>    z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb63-10"><a href="#cb63-10"></a>    NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb63-11"><a href="#cb63-11"></a>    block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb63-12"><a href="#cb63-12"></a>    block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb63-13"><a href="#cb63-13"></a>    i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb63-14"><a href="#cb63-14"></a>    (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb63-15"><a href="#cb63-15"></a>}</span>
<span id="cb63-16"><a href="#cb63-16"></a></span>
<span id="cb63-17"><a href="#cb63-17"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb63-18"><a href="#cb63-18"></a>    boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb63-19"><a href="#cb63-19"></a>                     <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb63-20"><a href="#cb63-20"></a>    ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb63-21"><a href="#cb63-21"></a>    p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb63-22"><a href="#cb63-22"></a>    <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb63-23"><a href="#cb63-23"></a>}</span>
<span id="cb63-24"><a href="#cb63-24"></a></span>
<span id="cb63-25"><a href="#cb63-25"></a>m &lt;-<span class="st"> </span><span class="dv">100</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; mu &lt;-<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb63-26"><a href="#cb63-26"></a>R&lt;-<span class="dv">999</span>;alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb63-27"><a href="#cb63-27"></a>n &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">10</span>);</span>
<span id="cb63-28"><a href="#cb63-28"></a></span>
<span id="cb63-29"><a href="#cb63-29"></a></span>
<span id="cb63-30"><a href="#cb63-30"></a><span class="co"># Unequal variances and equal expectations</span></span>
<span id="cb63-31"><a href="#cb63-31"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb63-32"><a href="#cb63-32"></a>pows &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="kw">length</span>(n), <span class="dv">3</span>)</span>
<span id="cb63-33"><a href="#cb63-33"></a></span>
<span id="cb63-34"><a href="#cb63-34"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb63-35"><a href="#cb63-35"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb63-36"><a href="#cb63-36"></a>        n1&lt;-n2&lt;-<span class="st"> </span>n[k]</span>
<span id="cb63-37"><a href="#cb63-37"></a>        N &lt;-<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb63-38"><a href="#cb63-38"></a>        x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n1, <span class="dt">mu=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">Sigma=</span><span class="kw">diag</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>)))</span>
<span id="cb63-39"><a href="#cb63-39"></a>        y &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n2, <span class="dt">mu=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">Sigma=</span><span class="kw">diag</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)))</span>
<span id="cb63-40"><a href="#cb63-40"></a>        z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb63-41"><a href="#cb63-41"></a>        p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb63-42"><a href="#cb63-42"></a>        p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb63-43"><a href="#cb63-43"></a>        p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb63-44"><a href="#cb63-44"></a>    }</span>
<span id="cb63-45"><a href="#cb63-45"></a>    pows[k,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] =<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb63-46"><a href="#cb63-46"></a>}</span>
<span id="cb63-47"><a href="#cb63-47"></a></span>
<span id="cb63-48"><a href="#cb63-48"></a></span>
<span id="cb63-49"><a href="#cb63-49"></a><span class="kw">plot</span>(n, pows[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">1</span>], <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>, <span class="dt">lwd=</span><span class="dv">1</span>)</span>
<span id="cb63-50"><a href="#cb63-50"></a><span class="kw">lines</span>(n, pows[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">2</span>], <span class="dt">type=</span><span class="st">&#39;b&#39;</span>,<span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb63-51"><a href="#cb63-51"></a><span class="kw">lines</span>(n, pows[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">3</span>], <span class="dt">type=</span><span class="st">&#39;b&#39;</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&#39;green&#39;</span>)</span>
<span id="cb63-52"><a href="#cb63-52"></a></span>
<span id="cb63-53"><a href="#cb63-53"></a><span class="co"># Unequal variances and unequal expectations</span></span>
<span id="cb63-54"><a href="#cb63-54"></a>pow2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="kw">length</span>(n), <span class="dv">3</span>)</span>
<span id="cb63-55"><a href="#cb63-55"></a>p.values2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, m, <span class="dv">3</span>)</span>
<span id="cb63-56"><a href="#cb63-56"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb63-57"><a href="#cb63-57"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb63-58"><a href="#cb63-58"></a>        n1&lt;-n2&lt;-<span class="st"> </span>n[k]</span>
<span id="cb63-59"><a href="#cb63-59"></a>        N &lt;-<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb63-60"><a href="#cb63-60"></a>        x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n1, <span class="dt">mu=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>), <span class="dt">Sigma=</span><span class="kw">diag</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>)))</span>
<span id="cb63-61"><a href="#cb63-61"></a>        y &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n2, <span class="dt">mu=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">Sigma=</span><span class="kw">diag</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)))</span>
<span id="cb63-62"><a href="#cb63-62"></a>        z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb63-63"><a href="#cb63-63"></a>        p.values2[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb63-64"><a href="#cb63-64"></a>        p.values2[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb63-65"><a href="#cb63-65"></a>        p.values2[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb63-66"><a href="#cb63-66"></a>    }</span>
<span id="cb63-67"><a href="#cb63-67"></a>    pow2[k,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] =<span class="st"> </span><span class="kw">colMeans</span>(p.values2<span class="op">&lt;</span>alpha)</span>
<span id="cb63-68"><a href="#cb63-68"></a>}</span>
<span id="cb63-69"><a href="#cb63-69"></a></span>
<span id="cb63-70"><a href="#cb63-70"></a><span class="kw">plot</span>(n, pow2[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">1</span>], <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>, <span class="dt">lwd=</span><span class="dv">1</span>)</span>
<span id="cb63-71"><a href="#cb63-71"></a><span class="kw">lines</span>(n, pow2[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">2</span>], <span class="dt">type=</span><span class="st">&#39;b&#39;</span>,<span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb63-72"><a href="#cb63-72"></a><span class="kw">lines</span>(n, pow2[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">3</span>], <span class="dt">type=</span><span class="st">&#39;b&#39;</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&#39;green&#39;</span>)</span>
<span id="cb63-73"><a href="#cb63-73"></a></span>
<span id="cb63-74"><a href="#cb63-74"></a></span>
<span id="cb63-75"><a href="#cb63-75"></a><span class="co"># t-distribution with 1 dim and bimodel distribution</span></span>
<span id="cb63-76"><a href="#cb63-76"></a>pow3 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="kw">length</span>(n), <span class="dv">3</span>)</span>
<span id="cb63-77"><a href="#cb63-77"></a>p.values3 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, m, <span class="dv">3</span>)</span>
<span id="cb63-78"><a href="#cb63-78"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb63-79"><a href="#cb63-79"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb63-80"><a href="#cb63-80"></a>        n1&lt;-n2&lt;-<span class="st"> </span>n[k]</span>
<span id="cb63-81"><a href="#cb63-81"></a>        N &lt;-<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb63-82"><a href="#cb63-82"></a>        x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span><span class="dv">2</span>,<span class="dv">1</span>),<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb63-83"><a href="#cb63-83"></a>        y1 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n2<span class="op">/</span><span class="dv">2</span>, <span class="dt">mu=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">Sigma=</span><span class="kw">diag</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)))</span>
<span id="cb63-84"><a href="#cb63-84"></a>        y2 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n2<span class="op">-</span>n2<span class="op">/</span><span class="dv">2</span>, <span class="dt">mu=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">Sigma=</span><span class="kw">diag</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)))</span>
<span id="cb63-85"><a href="#cb63-85"></a>        y &lt;-<span class="st"> </span><span class="kw">rbind</span>(y1,y2)</span>
<span id="cb63-86"><a href="#cb63-86"></a>        z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb63-87"><a href="#cb63-87"></a>        p.values3[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb63-88"><a href="#cb63-88"></a>        p.values3[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb63-89"><a href="#cb63-89"></a>        p.values3[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb63-90"><a href="#cb63-90"></a>    }</span>
<span id="cb63-91"><a href="#cb63-91"></a>    pow3[k,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] =<span class="st"> </span><span class="kw">colMeans</span>(p.values3<span class="op">&lt;</span>alpha)</span>
<span id="cb63-92"><a href="#cb63-92"></a>}</span>
<span id="cb63-93"><a href="#cb63-93"></a></span>
<span id="cb63-94"><a href="#cb63-94"></a><span class="kw">plot</span>(n, pow3[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">1</span>], <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>, <span class="dt">lwd=</span><span class="dv">1</span>)</span>
<span id="cb63-95"><a href="#cb63-95"></a><span class="kw">lines</span>(n, pow3[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">2</span>], <span class="dt">type=</span><span class="st">&#39;b&#39;</span>,<span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb63-96"><a href="#cb63-96"></a><span class="kw">lines</span>(n, pow3[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">3</span>], <span class="dt">type=</span><span class="st">&#39;b&#39;</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&#39;green&#39;</span>)</span>
<span id="cb63-97"><a href="#cb63-97"></a></span>
<span id="cb63-98"><a href="#cb63-98"></a></span>
<span id="cb63-99"><a href="#cb63-99"></a><span class="co"># unbalanced samples</span></span>
<span id="cb63-100"><a href="#cb63-100"></a>pow4 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="kw">length</span>(n), <span class="dv">3</span>)</span>
<span id="cb63-101"><a href="#cb63-101"></a>p.values4 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, m, <span class="dv">3</span>)</span>
<span id="cb63-102"><a href="#cb63-102"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb63-103"><a href="#cb63-103"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb63-104"><a href="#cb63-104"></a>        n1&lt;-<span class="st"> </span>n[k]<span class="op">/</span><span class="dv">2</span></span>
<span id="cb63-105"><a href="#cb63-105"></a>        n2&lt;-<span class="st"> </span>n[k]</span>
<span id="cb63-106"><a href="#cb63-106"></a>        N &lt;-<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb63-107"><a href="#cb63-107"></a>        x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n1, <span class="dt">mu=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">Sigma=</span><span class="kw">diag</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)))</span>
<span id="cb63-108"><a href="#cb63-108"></a>        y &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n2, <span class="dt">mu=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">Sigma=</span><span class="kw">diag</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)))</span>
<span id="cb63-109"><a href="#cb63-109"></a>        z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb63-110"><a href="#cb63-110"></a>        p.values4[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb63-111"><a href="#cb63-111"></a>        p.values4[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb63-112"><a href="#cb63-112"></a>        p.values4[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb63-113"><a href="#cb63-113"></a>    }</span>
<span id="cb63-114"><a href="#cb63-114"></a>    pow4[k,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] =<span class="st"> </span><span class="kw">colMeans</span>(p.values4<span class="op">&lt;</span>alpha)</span>
<span id="cb63-115"><a href="#cb63-115"></a>}</span>
<span id="cb63-116"><a href="#cb63-116"></a></span>
<span id="cb63-117"><a href="#cb63-117"></a><span class="kw">plot</span>(n, pow4[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">1</span>],<span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>, <span class="dt">lwd=</span><span class="dv">1</span>)</span>
<span id="cb63-118"><a href="#cb63-118"></a><span class="kw">lines</span>(n, pow4[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">2</span>], <span class="dt">type=</span><span class="st">&#39;b&#39;</span>,<span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb63-119"><a href="#cb63-119"></a><span class="kw">lines</span>(n, pow4[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">3</span>], <span class="dt">type=</span><span class="st">&#39;b&#39;</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&#39;green&#39;</span>)</span></code></pre></div>
</div>
</div>
</div>
<div id="homework-8" class="section level1">
<h1>HOMEWORK 8</h1>
<div id="question-6" class="section level2">
<h2>Question</h2>
<div id="section-30" class="section level3">
<h3>1.</h3>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="section-31" class="section level3">
<h3>2.</h3>
<p>For Exercise 1, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R} &lt; 1.2\)</span>.</p>
</div>
<div id="section-32" class="section level3">
<h3>3.</h3>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0, \sqrt{k})\)</span> of the curves <span class="math display">\[S_{k-1}(a)=P\Bigg(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}}\Bigg)\]</span> and <span class="math display">\[S_{k}(a)=P\Bigg(t(k)&gt;\sqrt{\frac{a^2k}{k+1-a^2}}\Bigg),\]</span> for <span class="math inline">\(k = 4 : 25, 100, 500, 1000\)</span>, where <span class="math inline">\(t(k)\)</span> is a Student t random variable with <span class="math inline">\(k\)</span> degrees of freedom.</p>
</div>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div id="section-33" class="section level3">
<h3>1.</h3>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="kw">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb64-3"><a href="#cb64-3"></a>dlaplace &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb64-4"><a href="#cb64-4"></a>    <span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</span>
<span id="cb64-5"><a href="#cb64-5"></a>}</span>
<span id="cb64-6"><a href="#cb64-6"></a>qlaplace &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb64-7"><a href="#cb64-7"></a>    y &lt;-<span class="st"> </span>x</span>
<span id="cb64-8"><a href="#cb64-8"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)) {</span>
<span id="cb64-9"><a href="#cb64-9"></a>        <span class="cf">if</span>(x[i]<span class="op">&gt;=</span><span class="fl">0.5</span>) {</span>
<span id="cb64-10"><a href="#cb64-10"></a>            y[i] &lt;-<span class="st"> </span><span class="kw">qexp</span>(<span class="dv">2</span><span class="op">*</span>x[i]<span class="op">-</span><span class="dv">1</span>, <span class="dt">rate=</span><span class="dv">1</span>)</span>
<span id="cb64-11"><a href="#cb64-11"></a>        }</span>
<span id="cb64-12"><a href="#cb64-12"></a>        <span class="cf">else</span> {</span>
<span id="cb64-13"><a href="#cb64-13"></a>            y[i] &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">qexp</span>(<span class="dv">1-2</span><span class="op">*</span>x[i], <span class="dt">rate=</span><span class="dv">1</span>)</span>
<span id="cb64-14"><a href="#cb64-14"></a>        }</span>
<span id="cb64-15"><a href="#cb64-15"></a>    }</span>
<span id="cb64-16"><a href="#cb64-16"></a>    <span class="kw">return</span>(y)</span>
<span id="cb64-17"><a href="#cb64-17"></a>}</span>
<span id="cb64-18"><a href="#cb64-18"></a></span>
<span id="cb64-19"><a href="#cb64-19"></a>rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb64-20"><a href="#cb64-20"></a>    x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb64-21"><a href="#cb64-21"></a>    x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb64-22"><a href="#cb64-22"></a>    u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb64-23"><a href="#cb64-23"></a>    k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb64-24"><a href="#cb64-24"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb64-25"><a href="#cb64-25"></a>        y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb64-26"><a href="#cb64-26"></a>        <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">dlaplace</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">dlaplace</span>(x[i<span class="dv">-1</span>])))</span>
<span id="cb64-27"><a href="#cb64-27"></a>            x[i] &lt;-<span class="st"> </span>y</span>
<span id="cb64-28"><a href="#cb64-28"></a>        <span class="cf">else</span> {</span>
<span id="cb64-29"><a href="#cb64-29"></a>            x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb64-30"><a href="#cb64-30"></a>            k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb64-31"><a href="#cb64-31"></a>        }</span>
<span id="cb64-32"><a href="#cb64-32"></a>    }</span>
<span id="cb64-33"><a href="#cb64-33"></a>    <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</span>
<span id="cb64-34"><a href="#cb64-34"></a>}</span>
<span id="cb64-35"><a href="#cb64-35"></a></span>
<span id="cb64-36"><a href="#cb64-36"></a>N &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb64-37"><a href="#cb64-37"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>,  <span class="dv">16</span>)</span>
<span id="cb64-38"><a href="#cb64-38"></a></span>
<span id="cb64-39"><a href="#cb64-39"></a>x0 &lt;-<span class="st"> </span><span class="dv">25</span></span>
<span id="cb64-40"><a href="#cb64-40"></a>rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb64-41"><a href="#cb64-41"></a>rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb64-42"><a href="#cb64-42"></a>rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb64-43"><a href="#cb64-43"></a>rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb64-44"><a href="#cb64-44"></a></span>
<span id="cb64-45"><a href="#cb64-45"></a><span class="co">#number of candidate points rejected</span></span>
<span id="cb64-46"><a href="#cb64-46"></a>no.reject &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sigma=</span>sigma,<span class="dt">no.reject=</span><span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k))</span>
<span id="cb64-47"><a href="#cb64-47"></a>knitr<span class="op">::</span><span class="kw">kable</span>(no.reject,<span class="dt">format=</span><span class="st">&#39;latex&#39;</span>)</span></code></pre></div>

<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))  <span class="co">#display 4 graphs together</span></span>
<span id="cb65-2"><a href="#cb65-2"></a>refline &lt;-<span class="st"> </span><span class="kw">qlaplace</span>(<span class="kw">c</span>(.<span class="dv">025</span>, <span class="fl">.975</span>))</span>
<span id="cb65-3"><a href="#cb65-3"></a>rw &lt;-<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x,  rw4<span class="op">$</span>x)</span>
<span id="cb65-4"><a href="#cb65-4"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb65-5"><a href="#cb65-5"></a>    <span class="kw">plot</span>(rw[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb65-6"><a href="#cb65-6"></a>            <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</span>
<span id="cb65-7"><a href="#cb65-7"></a>            <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</span>
<span id="cb65-8"><a href="#cb65-8"></a>    <span class="kw">abline</span>(<span class="dt">h=</span>refline)</span>
<span id="cb65-9"><a href="#cb65-9"></a>}</span>
<span id="cb65-10"><a href="#cb65-10"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#reset to default</span></span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="kw">seq</span>(.<span class="dv">1</span>, <span class="fl">.9</span>, <span class="fl">.1</span>), <span class="fl">.95</span>)</span>
<span id="cb66-2"><a href="#cb66-2"></a>Q &lt;-<span class="st"> </span><span class="kw">qlaplace</span>(a)</span>
<span id="cb66-3"><a href="#cb66-3"></a>rw &lt;-<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x, rw4<span class="op">$</span>x)</span>
<span id="cb66-4"><a href="#cb66-4"></a>mc &lt;-<span class="st"> </span>rw[<span class="dv">501</span><span class="op">:</span>N, ]</span>
<span id="cb66-5"><a href="#cb66-5"></a>Qrw &lt;-<span class="st"> </span><span class="kw">apply</span>(mc, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="kw">quantile</span>(x, a))</span>
<span id="cb66-6"><a href="#cb66-6"></a>qq &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">round</span>(<span class="kw">cbind</span>(Q, Qrw), <span class="dv">3</span>))</span>
<span id="cb66-7"><a href="#cb66-7"></a><span class="kw">names</span>(qq) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;True&#39;</span>,<span class="st">&#39;sigma=0.05&#39;</span>,<span class="st">&#39;sigma=0.5&#39;</span>,<span class="st">&#39;sigma=2&#39;</span>,<span class="st">&#39;sigma=16&#39;</span>)</span>
<span id="cb66-8"><a href="#cb66-8"></a>knitr<span class="op">::</span><span class="kw">kable</span>(qq,<span class="dt">format=</span><span class="st">&#39;latex&#39;</span>,) <span class="co">#latex format</span></span></code></pre></div>

</div>
<div id="section-34" class="section level3">
<h3>2.</h3>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span>
<span id="cb67-2"><a href="#cb67-2"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb67-3"><a href="#cb67-3"></a>    <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb67-4"><a href="#cb67-4"></a>    <span class="co"># for chain in i-th row of X</span></span>
<span id="cb67-5"><a href="#cb67-5"></a>    psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb67-6"><a href="#cb67-6"></a>    n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb67-7"><a href="#cb67-7"></a>    k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb67-8"><a href="#cb67-8"></a></span>
<span id="cb67-9"><a href="#cb67-9"></a>    psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb67-10"><a href="#cb67-10"></a>    B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb67-11"><a href="#cb67-11"></a>    psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb67-12"><a href="#cb67-12"></a>    W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb67-13"><a href="#cb67-13"></a>    v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb67-14"><a href="#cb67-14"></a>    r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W             <span class="co">#G-R statistic</span></span>
<span id="cb67-15"><a href="#cb67-15"></a>    <span class="kw">return</span>(r.hat)</span>
<span id="cb67-16"><a href="#cb67-16"></a>}</span>
<span id="cb67-17"><a href="#cb67-17"></a></span>
<span id="cb67-18"><a href="#cb67-18"></a></span>
<span id="cb67-19"><a href="#cb67-19"></a>dlaplace &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb67-20"><a href="#cb67-20"></a>    <span class="co">#Laplace p.d.f.</span></span>
<span id="cb67-21"><a href="#cb67-21"></a>      <span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</span>
<span id="cb67-22"><a href="#cb67-22"></a>}</span>
<span id="cb67-23"><a href="#cb67-23"></a></span>
<span id="cb67-24"><a href="#cb67-24"></a>laplace.chain &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, N, X1) {</span>
<span id="cb67-25"><a href="#cb67-25"></a>    <span class="co">#generates a Metropolis chain for Laplace</span></span>
<span id="cb67-26"><a href="#cb67-26"></a>    <span class="co">#with Normal(X[t], sigma) proposal distribution</span></span>
<span id="cb67-27"><a href="#cb67-27"></a>    <span class="co">#and starting value X1</span></span>
<span id="cb67-28"><a href="#cb67-28"></a>    x &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb67-29"><a href="#cb67-29"></a>    x[<span class="dv">1</span>] &lt;-<span class="st"> </span>X1</span>
<span id="cb67-30"><a href="#cb67-30"></a>    u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb67-31"><a href="#cb67-31"></a></span>
<span id="cb67-32"><a href="#cb67-32"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb67-33"><a href="#cb67-33"></a>        xt &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb67-34"><a href="#cb67-34"></a>        y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, xt, sigma)     <span class="co">#candidate point</span></span>
<span id="cb67-35"><a href="#cb67-35"></a>        r1 &lt;-<span class="st"> </span><span class="kw">dlaplace</span>(y) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(xt, y, sigma)</span>
<span id="cb67-36"><a href="#cb67-36"></a>        r2 &lt;-<span class="st"> </span><span class="kw">dlaplace</span>(xt) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(y, xt, sigma)</span>
<span id="cb67-37"><a href="#cb67-37"></a>        r &lt;-<span class="st"> </span>r1 <span class="op">/</span><span class="st"> </span>r2</span>
<span id="cb67-38"><a href="#cb67-38"></a>        <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>r) x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span></span>
<span id="cb67-39"><a href="#cb67-39"></a>                x[i] &lt;-<span class="st"> </span>xt</span>
<span id="cb67-40"><a href="#cb67-40"></a>    }</span>
<span id="cb67-41"><a href="#cb67-41"></a>        <span class="kw">return</span>(x)</span>
<span id="cb67-42"><a href="#cb67-42"></a>}</span>
<span id="cb67-43"><a href="#cb67-43"></a></span>
<span id="cb67-44"><a href="#cb67-44"></a>sigma &lt;-<span class="st"> </span><span class="dv">1</span>     <span class="co">#parameter of proposal distribution</span></span>
<span id="cb67-45"><a href="#cb67-45"></a>k &lt;-<span class="st"> </span><span class="dv">4</span>          <span class="co">#number of chains to generate</span></span>
<span id="cb67-46"><a href="#cb67-46"></a>n &lt;-<span class="st"> </span><span class="dv">15000</span>      <span class="co">#length of chains</span></span>
<span id="cb67-47"><a href="#cb67-47"></a>b &lt;-<span class="st"> </span><span class="dv">1000</span>       <span class="co">#burn-in length</span></span>
<span id="cb67-48"><a href="#cb67-48"></a></span>
<span id="cb67-49"><a href="#cb67-49"></a>    <span class="co">#choose overdispersed initial values</span></span>
<span id="cb67-50"><a href="#cb67-50"></a>x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">-5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb67-51"><a href="#cb67-51"></a></span>
<span id="cb67-52"><a href="#cb67-52"></a><span class="co">#generate the chains</span></span>
<span id="cb67-53"><a href="#cb67-53"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb67-54"><a href="#cb67-54"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</span>
<span id="cb67-55"><a href="#cb67-55"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb67-56"><a href="#cb67-56"></a>    X[i, ] &lt;-<span class="st"> </span><span class="kw">laplace.chain</span>(sigma, n, x0[i])</span>
<span id="cb67-57"><a href="#cb67-57"></a></span>
<span id="cb67-58"><a href="#cb67-58"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb67-59"><a href="#cb67-59"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb67-60"><a href="#cb67-60"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb67-61"><a href="#cb67-61"></a>    psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb67-62"><a href="#cb67-62"></a></span>
<span id="cb67-63"><a href="#cb67-63"></a><span class="co">#plot psi for the four chains</span></span>
<span id="cb67-64"><a href="#cb67-64"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb67-65"><a href="#cb67-65"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb67-66"><a href="#cb67-66"></a>    <span class="cf">if</span>(i<span class="op">==</span><span class="dv">1</span>){</span>
<span id="cb67-67"><a href="#cb67-67"></a>        <span class="kw">plot</span>((b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n],<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.2</span>,<span class="fl">0.2</span>), <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb67-68"><a href="#cb67-68"></a>            <span class="dt">xlab=</span><span class="st">&#39;Index&#39;</span>, <span class="dt">ylab=</span><span class="kw">bquote</span>(phi))</span>
<span id="cb67-69"><a href="#cb67-69"></a>      }<span class="cf">else</span>{</span>
<span id="cb67-70"><a href="#cb67-70"></a>        <span class="kw">lines</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">col=</span>i)</span>
<span id="cb67-71"><a href="#cb67-71"></a>    }</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></span></code></pre></div>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb69-2"><a href="#cb69-2"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb69-3"><a href="#cb69-3"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)</span>
<span id="cb69-4"><a href="#cb69-4"></a>    rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb69-5"><a href="#cb69-5"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb69-6"><a href="#cb69-6"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-35" class="section level3">
<h3>3.</h3>
<p>We can do some computation to simplify the question. <span class="math display">\[
\begin{aligned}
S_{k-1}(a)=P\Bigg(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}}\Bigg)=&amp;
\frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)} \Gamma\left(\frac{k-1}{2}\right)} \int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k / 2} d u \\
=&amp; \frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k} \Gamma\left(\frac{k}{2}\right)} \int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1) / 2} d u
\end{aligned}
\]</span> for <span class="math display">\[ c_{k} =\sqrt{\frac{a^{2} k}{k+1-a^{2}}}\]</span></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span>
<span id="cb70-2"><a href="#cb70-2"></a></span>
<span id="cb70-3"><a href="#cb70-3"></a>inte.fun &lt;-<span class="st"> </span><span class="cf">function</span>(a,k){</span>
<span id="cb70-4"><a href="#cb70-4"></a> ck &lt;-<span class="st"> </span><span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb70-5"><a href="#cb70-5"></a> part1 &lt;-<span class="st"> </span><span class="kw">integrate</span>(<span class="cf">function</span>(u){(<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)},<span class="dv">0</span>,ck)<span class="op">$</span>value</span>
<span id="cb70-6"><a href="#cb70-6"></a> part2 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(pi<span class="op">*</span>k)<span class="op">*</span><span class="kw">exp</span>(<span class="kw">lgamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb70-7"><a href="#cb70-7"></a> part1<span class="op">*</span>part2</span>
<span id="cb70-8"><a href="#cb70-8"></a>}</span>
<span id="cb70-9"><a href="#cb70-9"></a></span>
<span id="cb70-10"><a href="#cb70-10"></a>root.solve &lt;-<span class="st"> </span><span class="cf">function</span>(k){</span>
<span id="cb70-11"><a href="#cb70-11"></a>  output =<span class="st"> </span><span class="kw">uniroot</span>(<span class="cf">function</span>(a){<span class="kw">inte.fun</span>(a,k)<span class="op">-</span><span class="kw">inte.fun</span>(a,k<span class="dv">-1</span>)},<span class="dt">lower=</span><span class="dv">1</span>,<span class="dt">upper=</span><span class="dv">2</span>)</span>
<span id="cb70-12"><a href="#cb70-12"></a>  output<span class="op">$</span>root</span>
<span id="cb70-13"><a href="#cb70-13"></a>}</span>
<span id="cb70-14"><a href="#cb70-14"></a></span>
<span id="cb70-15"><a href="#cb70-15"></a>k &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb70-16"><a href="#cb70-16"></a>roots &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="kw">length</span>(k))</span>
<span id="cb70-17"><a href="#cb70-17"></a></span>
<span id="cb70-18"><a href="#cb70-18"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k)){</span>
<span id="cb70-19"><a href="#cb70-19"></a>  roots[<span class="dv">2</span>,i] &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">root.solve</span>(k[i]),<span class="dv">4</span>)</span>
<span id="cb70-20"><a href="#cb70-20"></a>}</span>
<span id="cb70-21"><a href="#cb70-21"></a></span>
<span id="cb70-22"><a href="#cb70-22"></a>roots[<span class="dv">1</span>,] &lt;-<span class="st"> </span>k</span>
<span id="cb70-23"><a href="#cb70-23"></a><span class="kw">rownames</span>(roots) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;df&#39;</span>,<span class="st">&#39;root&#39;</span>)</span>
<span id="cb70-24"><a href="#cb70-24"></a>roots</span></code></pre></div>
<pre><code>#        [,1]    [,2]     [,3]     [,4]      [,5]
# df   4.0000 25.0000 100.0000 500.0000 1000.0000
# root 1.4921  1.6874   1.7206   1.7298    1.7309</code></pre>
</div>
</div>
</div>
<div id="homework-9" class="section level1">
<h1>HOMEWORK 9</h1>
<div id="question-7" class="section level2">
<h2>Question</h2>
<div id="section-36" class="section level3">
<h3>1.</h3>
<p>A-B-O blood type problem I Let the three alleles be A, B, and O.</p>
<table>
<thead>
<tr class="header">
<th>Genotype</th>
<th>AA</th>
<th>BB</th>
<th>OO</th>
<th>AO</th>
<th>BO</th>
<th>AB</th>
<th>Sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Frequency</td>
<td><span class="math inline">\(p^2\)</span></td>
<td><span class="math inline">\(q^2\)</span></td>
<td><span class="math inline">\(r^2\)</span></td>
<td><span class="math inline">\(2pr\)</span></td>
<td><span class="math inline">\(2qr\)</span></td>
<td><span class="math inline">\(2pq\)</span></td>
<td><span class="math inline">\(1\)</span></td>
</tr>
<tr class="even">
<td>Count</td>
<td><span class="math inline">\(n_{AA}\)</span></td>
<td><span class="math inline">\(n_{BB}\)</span></td>
<td><span class="math inline">\(n_{OO}\)</span></td>
<td><span class="math inline">\(n_{AO}\)</span></td>
<td><span class="math inline">\(n_{BO}\)</span></td>
<td><span class="math inline">\(n_{AB}\)</span></td>
<td><span class="math inline">\(n\)</span></td>
</tr>
</tbody>
</table>
<p>I Observed data: <span class="math inline">\(n_{A\cdot} = n_{AA} + n_{AO} = 444\)</span> (A-type), <span class="math inline">\(n_{B\cdot} = n_{BB} + n_{BO}=132\)</span>(B-type), <span class="math inline">\(n_{OO} = 361\)</span> (O-type), <span class="math inline">\(n_{AB} = 63\)</span> (AB-type). I Use EM algorithm to solve MLE of p and q (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>). I Record the values of p and q that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing</p>
</div>
<div id="section-37" class="section level3">
<h3>2.</h3>
<p>Use both for loops and <code>lapply()</code> to fit linear models to the mtcars using the formulas stored in this list:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb72-2"><a href="#cb72-2"></a>    mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb72-3"><a href="#cb72-3"></a>    mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb72-4"><a href="#cb72-4"></a>    mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb72-5"><a href="#cb72-5"></a>    mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb72-6"><a href="#cb72-6"></a>)</span></code></pre></div>
</div>
<div id="section-38" class="section level3">
<h3>3.</h3>
<p>(1). The following code simulates the performance of a t-test for non-normal data. Use <code>sapply()</code> and an anonymous function to extract the p-value from every trial.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb73-2"><a href="#cb73-2"></a>    <span class="dv">100</span>,</span>
<span id="cb73-3"><a href="#cb73-3"></a>    <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb73-4"><a href="#cb73-4"></a>    <span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb73-5"><a href="#cb73-5"></a>)</span></code></pre></div>
<p>(2). Implement a combination of <code>Map()</code> and <code>vapply()</code> to create an <code>lapply()</code> variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
</div>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div id="section-39" class="section level3">
<h3>1.</h3>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span>
<span id="cb74-2"><a href="#cb74-2"></a><span class="kw">library</span>(nloptr)</span>
<span id="cb74-3"><a href="#cb74-3"></a></span>
<span id="cb74-4"><a href="#cb74-4"></a>mle.fun &lt;-<span class="st"> </span><span class="cf">function</span>(x,y,<span class="dt">n.A=</span><span class="dv">444</span>,<span class="dt">n.B=</span><span class="dv">132</span>,<span class="dt">nOO=</span><span class="dv">361</span>,<span class="dt">nAB=</span><span class="dv">63</span>) {</span>
<span id="cb74-5"><a href="#cb74-5"></a>  r1 =<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(y); r =<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(x) </span>
<span id="cb74-6"><a href="#cb74-6"></a>  nBB =<span class="st"> </span>n.B<span class="op">*</span>y[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>y[<span class="dv">2</span>]<span class="op">*</span>r1<span class="op">+</span>y[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span>); nAA =<span class="st"> </span>n.A<span class="op">*</span>y[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(y[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>y[<span class="dv">1</span>]<span class="op">*</span>r1)</span>
<span id="cb74-7"><a href="#cb74-7"></a>  result &lt;-<span class="st"> </span><span class="dv">-2</span><span class="op">*</span>nBB<span class="op">*</span><span class="kw">log</span>(x[<span class="dv">2</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nOO<span class="op">*</span><span class="kw">log</span>(r)<span class="op">-</span>(n.A<span class="op">-</span>nAA)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">*</span>r)<span class="op">-</span></span>
<span id="cb74-8"><a href="#cb74-8"></a><span class="st">      </span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">*</span>x[<span class="dv">2</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nAA<span class="op">*</span><span class="kw">log</span>(x[<span class="dv">1</span>])<span class="op">-</span>(n.B<span class="op">-</span>nBB)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x[<span class="dv">2</span>]<span class="op">*</span>r)</span>
<span id="cb74-9"><a href="#cb74-9"></a>  result</span>
<span id="cb74-10"><a href="#cb74-10"></a>}</span>
<span id="cb74-11"><a href="#cb74-11"></a></span>
<span id="cb74-12"><a href="#cb74-12"></a>constrain &lt;-<span class="st"> </span><span class="cf">function</span>(x,y,<span class="dt">n.A=</span><span class="dv">444</span>,<span class="dt">n.B=</span><span class="dv">132</span>,<span class="dt">nOO=</span><span class="dv">361</span>,<span class="dt">nAB=</span><span class="dv">63</span>) {</span>
<span id="cb74-13"><a href="#cb74-13"></a>  <span class="kw">return</span>(<span class="kw">sum</span>(x)<span class="op">-</span><span class="fl">0.999999</span>)</span>
<span id="cb74-14"><a href="#cb74-14"></a>}</span>
<span id="cb74-15"><a href="#cb74-15"></a></span>
<span id="cb74-16"><a href="#cb74-16"></a>opts =<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;algorithm&quot;</span>=<span class="st">&quot;NLOPT_LN_COBYLA&quot;</span>, <span class="st">&quot;xtol_rel&quot;</span>=<span class="fl">1.0e-8</span>)</span>
<span id="cb74-17"><a href="#cb74-17"></a>r =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>); r =<span class="st"> </span><span class="kw">rbind</span>(r,<span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.35</span>))<span class="co">#</span></span>
<span id="cb74-18"><a href="#cb74-18"></a>j =<span class="st"> </span><span class="dv">2</span>; mle =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb74-19"><a href="#cb74-19"></a><span class="cf">while</span> (<span class="kw">sum</span>(<span class="kw">abs</span>(r[j,]<span class="op">-</span>r[j<span class="dv">-1</span>,]))<span class="op">&gt;</span><span class="fl">1e-8</span>) {</span>
<span id="cb74-20"><a href="#cb74-20"></a>    res =<span class="st"> </span><span class="kw">nloptr</span>( <span class="dt">x0=</span><span class="kw">c</span>(<span class="fl">0.3</span>,<span class="fl">0.25</span>), <span class="dt">eval_f=</span>mle.fun,</span>
<span id="cb74-21"><a href="#cb74-21"></a>               <span class="dt">lb =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">ub =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">eval_g_ineq =</span> constrain, </span>
<span id="cb74-22"><a href="#cb74-22"></a>               <span class="dt">opts =</span> opts, <span class="dt">y=</span>r[j,],<span class="dt">n.A=</span><span class="dv">444</span>,<span class="dt">n.B=</span><span class="dv">132</span>,<span class="dt">nOO=</span><span class="dv">361</span>,<span class="dt">nAB=</span><span class="dv">63</span> )</span>
<span id="cb74-23"><a href="#cb74-23"></a>    j =<span class="st"> </span>j<span class="op">+</span><span class="dv">1</span></span>
<span id="cb74-24"><a href="#cb74-24"></a>    r =<span class="st"> </span><span class="kw">rbind</span>(r,res<span class="op">$</span>solution)</span>
<span id="cb74-25"><a href="#cb74-25"></a>    mle =<span class="st"> </span><span class="kw">c</span>(mle,<span class="kw">constrain</span>(<span class="dt">x=</span>r[j,],<span class="dt">y=</span>r[j<span class="dv">-1</span>,]))</span>
<span id="cb74-26"><a href="#cb74-26"></a>}</span>
<span id="cb74-27"><a href="#cb74-27"></a>r </span></code></pre></div>
<pre><code>#            [,1]      [,2]
#  [1,] 0.0000000 0.0000000
#  [2,] 0.2000000 0.3500000
#  [3,] 0.2938636 0.1159800
#  [4,] 0.2977537 0.1034051
#  [5,] 0.2977020 0.1027454
#  [6,] 0.2976539 0.1027089
#  [7,] 0.2976432 0.1027065
#  [8,] 0.2976411 0.1027063
#  [9,] 0.2976407 0.1027063
# [10,] 0.2976407 0.1027063
# [11,] 0.2976407 0.1027063
# [12,] 0.2976407 0.1027063</code></pre>
</div>
<div id="section-40" class="section level3">
<h3>2.</h3>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span>
<span id="cb76-2"><a href="#cb76-2"></a><span class="kw">attach</span>(mtcars)</span>
<span id="cb76-3"><a href="#cb76-3"></a></span>
<span id="cb76-4"><a href="#cb76-4"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb76-5"><a href="#cb76-5"></a>        mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb76-6"><a href="#cb76-6"></a>        mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb76-7"><a href="#cb76-7"></a>        mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb76-8"><a href="#cb76-8"></a>        mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb76-9"><a href="#cb76-9"></a>    )</span>
<span id="cb76-10"><a href="#cb76-10"></a></span>
<span id="cb76-11"><a href="#cb76-11"></a>regressions &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(formulas))</span>
<span id="cb76-12"><a href="#cb76-12"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">length</span>(formulas)) {</span>
<span id="cb76-13"><a href="#cb76-13"></a>    regressions[[i]]&lt;-<span class="kw">lm</span>(formulas[[i]], <span class="dt">data=</span>mtcars)</span>
<span id="cb76-14"><a href="#cb76-14"></a>}</span>
<span id="cb76-15"><a href="#cb76-15"></a>regressions</span></code></pre></div>
<pre><code># [[1]]
# NULL
# 
# [[2]]
# NULL
# 
# [[3]]
# NULL
# 
# [[4]]
# 
# Call:
# lm(formula = formulas[[i]], data = mtcars)
# 
# Coefficients:
# (Intercept)    I(1/disp)           wt  
#      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>regs &lt;-<span class="st"> </span><span class="kw">lapply</span>(formulas, <span class="cf">function</span>(x) <span class="kw">lm</span>(x, <span class="dt">data=</span>mtcars))</span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="kw">detach</span>(mtcars)</span>
<span id="cb78-3"><a href="#cb78-3"></a>regs</span></code></pre></div>
<pre><code># [[1]]
# 
# Call:
# lm(formula = x, data = mtcars)
# 
# Coefficients:
# (Intercept)         disp  
#    29.59985     -0.04122  
# 
# 
# [[2]]
# 
# Call:
# lm(formula = x, data = mtcars)
# 
# Coefficients:
# (Intercept)    I(1/disp)  
#       10.75      1557.67  
# 
# 
# [[3]]
# 
# Call:
# lm(formula = x, data = mtcars)
# 
# Coefficients:
# (Intercept)         disp           wt  
#    34.96055     -0.01772     -3.35083  
# 
# 
# [[4]]
# 
# Call:
# lm(formula = x, data = mtcars)
# 
# Coefficients:
# (Intercept)    I(1/disp)           wt  
#      19.024     1142.560       -1.798</code></pre>
</div>
<div id="section-41" class="section level3">
<h3>3.</h3>
<p>(1).</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span>
<span id="cb80-2"><a href="#cb80-2"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb80-3"><a href="#cb80-3"></a>    <span class="dv">100</span>, <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb80-4"><a href="#cb80-4"></a>    <span class="dt">simplify =</span> <span class="ot">FALSE</span>)</span>
<span id="cb80-5"><a href="#cb80-5"></a></span>
<span id="cb80-6"><a href="#cb80-6"></a>a &lt;-<span class="st"> </span><span class="kw">sapply</span>(trials, <span class="cf">function</span>(x) x<span class="op">$</span>p.value)</span>
<span id="cb80-7"><a href="#cb80-7"></a><span class="kw">head</span>(a)</span></code></pre></div>
<pre><code># [1] 0.6885337 0.9809363 0.3105510 0.1620096 0.8082457 0.7066845</code></pre>
<p>(2).</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())</span>
<span id="cb82-2"><a href="#cb82-2"></a>My_lapply &lt;-<span class="st"> </span><span class="cf">function</span>(X) {</span>
<span id="cb82-3"><a href="#cb82-3"></a>    n &lt;-<span class="st"> </span><span class="kw">nrow</span>(X)</span>
<span id="cb82-4"><a href="#cb82-4"></a>    result &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, n)</span>
<span id="cb82-5"><a href="#cb82-5"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) result[i] &lt;-<span class="st"> </span><span class="kw">Map</span>(sapply, <span class="kw">as.vector</span>(X[i,]), <span class="kw">c</span>(mean))</span>
<span id="cb82-6"><a href="#cb82-6"></a>    result</span>
<span id="cb82-7"><a href="#cb82-7"></a>}</span>
<span id="cb82-8"><a href="#cb82-8"></a>xx &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">30</span>), <span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb82-9"><a href="#cb82-9"></a>a &lt;-<span class="kw">My_lapply</span>(xx); a</span></code></pre></div>
<pre><code># [[1]]
# [1] -0.4020845
# 
# [[2]]
# [1] -0.7880141
# 
# [[3]]
# [1] 0.734431
# 
# [[4]]
# [1] 0.3172745
# 
# [[5]]
# [1] -1.145132
# 
# [[6]]
# [1] -1.238589
# 
# [[7]]
# [1] 2.206489
# 
# [[8]]
# [1] -1.920157
# 
# [[9]]
# [1] 0.3993569
# 
# [[10]]
# [1] -1.0048</code></pre>
</div>
</div>
</div>
<div id="homework-10" class="section level1">
<h1>HOMEWORK 10</h1>
<div id="question-8" class="section level2">
<h2>Question</h2>
<div id="section-42" class="section level3">
<h3>1.</h3>
<p>Write an Rcpp function for Exercise 9.4 (page 277, Statistical Computing with R).</p>
</div>
<div id="section-43" class="section level3">
<h3>2.</h3>
<p>Compare the corresponding generated random numbers with those by the R function you wrote before using the function <code>qqplot</code>.</p>
</div>
<div id="section-44" class="section level3">
<h3>3.</h3>
<p>Compare the computation time of the two functions with the function <code>microbenchmark</code>.</p>
</div>
<div id="section-45" class="section level3">
<h3>4.</h3>
<p>Comments your results.</p>
</div>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div id="section-46" class="section level3">
<h3>1.</h3>
<p>Complement the <code>rw_Metropolis</code> function in Ex.9.4.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb84-1"><a href="#cb84-1"></a><span class="pp">#include </span><span class="im">&lt;Rcpp.h&gt;</span></span>
<span id="cb84-2"><a href="#cb84-2"></a><span class="kw">using</span> <span class="kw">namespace</span> Rcpp;</span>
<span id="cb84-3"><a href="#cb84-3"></a></span>
<span id="cb84-4"><a href="#cb84-4"></a><span class="co">// [[Rcpp::export]]</span></span>
<span id="cb84-5"><a href="#cb84-5"></a>NumericVector dlaplace(NumericVector x) {</span>
<span id="cb84-6"><a href="#cb84-6"></a>    NumericVector y = <span class="fl">0.5</span>*exp(-abs(x));</span>
<span id="cb84-7"><a href="#cb84-7"></a>    <span class="cf">return</span> y;</span>
<span id="cb84-8"><a href="#cb84-8"></a>}</span>
<span id="cb84-9"><a href="#cb84-9"></a></span>
<span id="cb84-10"><a href="#cb84-10"></a><span class="dt">double</span> dlaplace(<span class="dt">double</span> x) {</span>
<span id="cb84-11"><a href="#cb84-11"></a>    <span class="dt">double</span> y = <span class="fl">0.5</span>*exp(-abs(x));</span>
<span id="cb84-12"><a href="#cb84-12"></a>    <span class="cf">return</span> y;</span>
<span id="cb84-13"><a href="#cb84-13"></a>}</span>
<span id="cb84-14"><a href="#cb84-14"></a></span>
<span id="cb84-15"><a href="#cb84-15"></a><span class="co">// [[Rcpp::export]]</span></span>
<span id="cb84-16"><a href="#cb84-16"></a>List rw_Metropolis(<span class="dt">double</span> sigma, <span class="dt">double</span> x0, <span class="dt">int</span> N) {</span>
<span id="cb84-17"><a href="#cb84-17"></a>    NumericVector x(N);</span>
<span id="cb84-18"><a href="#cb84-18"></a>    x[<span class="dv">0</span>] = x0;</span>
<span id="cb84-19"><a href="#cb84-19"></a>    NumericVector u = runif(N);</span>
<span id="cb84-20"><a href="#cb84-20"></a>    <span class="dt">int</span> k = <span class="dv">0</span>;</span>
<span id="cb84-21"><a href="#cb84-21"></a>    <span class="cf">for</span> (<span class="dt">int</span> i=<span class="dv">1</span>; i&lt;N; i++) {</span>
<span id="cb84-22"><a href="#cb84-22"></a>        <span class="dt">double</span> y = rnorm(<span class="dv">1</span>, x[i-<span class="dv">1</span>], sigma)[<span class="dv">0</span>];</span>
<span id="cb84-23"><a href="#cb84-23"></a>        <span class="cf">if</span> (u[i] &lt;= (dlaplace(y) / dlaplace(x[i-<span class="dv">1</span>])))</span>
<span id="cb84-24"><a href="#cb84-24"></a>            x[i] = y;</span>
<span id="cb84-25"><a href="#cb84-25"></a>        <span class="cf">else</span> {</span>
<span id="cb84-26"><a href="#cb84-26"></a>            x[i] = x[i-<span class="dv">1</span>];</span>
<span id="cb84-27"><a href="#cb84-27"></a>            k = k + <span class="dv">1</span>;</span>
<span id="cb84-28"><a href="#cb84-28"></a>        }</span>
<span id="cb84-29"><a href="#cb84-29"></a>    }</span>
<span id="cb84-30"><a href="#cb84-30"></a>    <span class="cf">return</span>(List::create(Named(<span class="st">&quot;x&quot;</span>)=x,</span>
<span id="cb84-31"><a href="#cb84-31"></a>                        Named(<span class="st">&quot;k&quot;</span>)=k));</span>
<span id="cb84-32"><a href="#cb84-32"></a>}</span></code></pre></div>
</div>
<div id="section-47" class="section level3">
<h3>2.</h3>
<p>Compare the corresponding generated random numbers with those by the R function wrote before.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="kw">library</span>(Rcpp); <span class="kw">library</span>(microbenchmark)</span>
<span id="cb85-2"><a href="#cb85-2"></a><span class="kw">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb85-3"><a href="#cb85-3"></a></span>
<span id="cb85-4"><a href="#cb85-4"></a>d.laplace &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb85-5"><a href="#cb85-5"></a>    <span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</span>
<span id="cb85-6"><a href="#cb85-6"></a>}</span>
<span id="cb85-7"><a href="#cb85-7"></a></span>
<span id="cb85-8"><a href="#cb85-8"></a>rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb85-9"><a href="#cb85-9"></a>    x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb85-10"><a href="#cb85-10"></a>    x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb85-11"><a href="#cb85-11"></a>    u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb85-12"><a href="#cb85-12"></a>    k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb85-13"><a href="#cb85-13"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb85-14"><a href="#cb85-14"></a>        y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb85-15"><a href="#cb85-15"></a>        <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">d.laplace</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">d.laplace</span>(x[i<span class="dv">-1</span>])))</span>
<span id="cb85-16"><a href="#cb85-16"></a>            x[i] &lt;-<span class="st"> </span>y</span>
<span id="cb85-17"><a href="#cb85-17"></a>        <span class="cf">else</span> {</span>
<span id="cb85-18"><a href="#cb85-18"></a>            x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb85-19"><a href="#cb85-19"></a>            k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb85-20"><a href="#cb85-20"></a>        }</span>
<span id="cb85-21"><a href="#cb85-21"></a>    }</span>
<span id="cb85-22"><a href="#cb85-22"></a>    <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</span>
<span id="cb85-23"><a href="#cb85-23"></a>}</span>
<span id="cb85-24"><a href="#cb85-24"></a></span>
<span id="cb85-25"><a href="#cb85-25"></a>N &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb85-26"><a href="#cb85-26"></a>sigma &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb85-27"><a href="#cb85-27"></a>x0 &lt;-<span class="st"> </span><span class="fl">25.0</span></span>
<span id="cb85-28"><a href="#cb85-28"></a>rwR =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma,x0,N)<span class="op">$</span>x[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">500</span>)]</span>
<span id="cb85-29"><a href="#cb85-29"></a>rwC =<span class="st"> </span><span class="kw">rw_Metropolis</span>(sigma,x0,N)<span class="op">$</span>x[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">500</span>)]</span>
<span id="cb85-30"><a href="#cb85-30"></a><span class="kw">qqplot</span>(rwR,rwC)</span>
<span id="cb85-31"><a href="#cb85-31"></a><span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</div>
<div id="section-48" class="section level3">
<h3>3.</h3>
<p>Compare the computation time of the two functions.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a>time.interval =<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rwS=</span><span class="kw">rw.Metropolis</span>(sigma,x0,N),</span>
<span id="cb86-2"><a href="#cb86-2"></a>                               <span class="dt">rwT=</span><span class="kw">rw_Metropolis</span>(sigma,x0,N))</span>
<span id="cb86-3"><a href="#cb86-3"></a>time.interval</span></code></pre></div>
</div>
<div id="section-49" class="section level3">
<h3>4.</h3>
<p>Using C++ can largely improve the computation efficiency.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
